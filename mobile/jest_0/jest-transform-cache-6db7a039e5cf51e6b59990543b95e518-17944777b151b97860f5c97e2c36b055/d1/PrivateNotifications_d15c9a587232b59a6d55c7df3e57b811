a72199a8488b0370ef025eba1765abf0
Object.defineProperty(exports,"__esModule",{value:true});exports.default=undefined;var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor);}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor;};}();var _reactNativeMaterialTextfield=require('react-native-material-textfield');var _expo=require('expo');var _react=require('react');var _react2=_interopRequireDefault(_react);var _reactNative=require('react-native');var _Const=require('../const/Const');function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}function _objectWithoutProperties(obj,keys){var target={};for(var i in obj){if(keys.indexOf(i)>=0)continue;if(!Object.prototype.hasOwnProperty.call(obj,i))continue;target[i]=obj[i];}return target;}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true});}else{obj[key]=value;}return obj;}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called");}return call&&(typeof call==="object"||typeof call==="function")?call:self;}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass;}var tk;function register(){var _ref,status,value;return regeneratorRuntime.async(function register$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return regeneratorRuntime.awrap(Expo.Permissions.askAsync(Expo.Permissions.NOTIFICATIONS));case 2:_ref=_context.sent;status=_ref.status;if(!(status!='granted')){_context.next=7;break;}alert('You need to enable permissions in settings');return _context.abrupt('return');case 7:_context.next=9;return regeneratorRuntime.awrap(Expo.Notifications.getExpoPushTokenAsync());case 9:value=_context.sent;tk=value;console.log(status,value);case 12:case'end':return _context.stop();}}},null,this);}var PrivateNotifications=function(_Component){_inherits(PrivateNotifications,_Component);_createClass(PrivateNotifications,[{key:'componentWillMount',value:function componentWillMount(){register();this.listener=Expo.Notifications.addListener(this.listen);}},{key:'componentWillUnmount',value:function componentWillUnmount(){this.listener&&Expo.Notifications.addListener(this.listen);}}]);function PrivateNotifications(props){var _this2=this;_classCallCheck(this,PrivateNotifications);var _this=_possibleConstructorReturn(this,(PrivateNotifications.__proto__||Object.getPrototypeOf(PrivateNotifications)).call(this,props));_this.listen=function(_ref2){var origin=_ref2.origin,data=_ref2.data;console.log('cool data',origin,data);};_this.onPressButton=function(){var errors={};var url=_Const.NOTIFICATIONS_API+'/send_push_message/';var errorPlate=false;var errorMessage=false;['plate'].forEach(function(text){var value=_this[text].value();if(!value){errors[text]='Campo obrigatório.';errorPlate=true;}else{if('plate'===text&&value.length<8){errors[text]='Placa inválida. Ex.:AAA-0000';errorPlate=true;}}});['message'].forEach(function(text){var value=_this[text].value();if(!value){errors[text]='Campo obrigatório.';errorMessage=true;}else{if('message'===text&&value.length<5){errors[text]='Forneça mais detalhes do ocorrido.';errorMessage=true;}}});if(errorPlate==false&&errorMessage==false){var notification=JSON.stringify({sender_id:tk,title:_this.state.title,plate:_this.state.plate,message:_this.state.message,image:_this.state.image});console.log(notification);fetch(url,{method:'POST',headers:{'Accept':'application/json','Content-Type':'application/json'},body:notification}).then(function(response){return response.json();}).then(function(jsonResponse){console.log(jsonResponse);_reactNative.Alert.alert("Notificação enviada!");}).catch(function(error){console.log(error);_reactNative.Alert.alert("Placa não existe!");});}_this.setState({errors:errors});};_this._maybeRenderUploadingOverlay=function(){if(_this.state.uploading){return _react2.default.createElement(_reactNative.View,{style:styles.maybeRenderUploading},_react2.default.createElement(_reactNative.ActivityIndicator,{color:'#313869',size:'large'}));}};_this._maybeRenderImage=function(){var image=_this.state.image;if(!image){return;}return _react2.default.createElement(_reactNative.View,{style:styles.maybeRenderContainer},_react2.default.createElement(_reactNative.View,{style:styles.maybeRenderImageContainer},_react2.default.createElement(_reactNative.Image,{source:{uri:image},style:styles.maybeRenderImage})));};_this._share=function(){Share.share({message:_this.state.image,title:'Check out this photo',url:_this.state.image});};_this._copyToClipboard=function(){Clipboard.setString(_this.state.image);alert('Copied image URL to clipboard');};_this._takePhoto=function _callee(){var _ref3,cameraPerm,_ref4,cameraRollPerm,pickerResult;return regeneratorRuntime.async(function _callee$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return regeneratorRuntime.awrap(_expo.Permissions.askAsync(_expo.Permissions.CAMERA));case 2:_ref3=_context2.sent;cameraPerm=_ref3.status;_context2.next=6;return regeneratorRuntime.awrap(_expo.Permissions.askAsync(_expo.Permissions.CAMERA_ROLL));case 6:_ref4=_context2.sent;cameraRollPerm=_ref4.status;if(!(cameraPerm==='granted'&&cameraRollPerm==='granted')){_context2.next=13;break;}_context2.next=11;return regeneratorRuntime.awrap(_expo.ImagePicker.launchCameraAsync({allowsEditing:true}));case 11:pickerResult=_context2.sent;_this._handleImagePicked(pickerResult);case 13:case'end':return _context2.stop();}}},null,_this2);};_this._pickImage=function _callee2(){var _ref5,cameraRollPerm,pickerResult;return regeneratorRuntime.async(function _callee2$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_context3.next=2;return regeneratorRuntime.awrap(_expo.Permissions.askAsync(_expo.Permissions.CAMERA_ROLL));case 2:_ref5=_context3.sent;cameraRollPerm=_ref5.status;if(!(cameraRollPerm==='granted')){_context3.next=9;break;}_context3.next=7;return regeneratorRuntime.awrap(_expo.ImagePicker.launchImageLibraryAsync({allowsEditing:true}));case 7:pickerResult=_context3.sent;_this._handleImagePicked(pickerResult);case 9:case'end':return _context3.stop();}}},null,_this2);};_this._handleImagePicked=function _callee3(pickerResult){var uploadResponse,uploadResult;return regeneratorRuntime.async(function _callee3$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:uploadResponse=void 0,uploadResult=void 0;_context4.prev=1;_this.setState({uploading:true});if(pickerResult.cancelled){_context4.next=12;break;}_context4.next=6;return regeneratorRuntime.awrap(uploadImageAsync(pickerResult.uri));case 6:uploadResponse=_context4.sent;_context4.next=9;return regeneratorRuntime.awrap(uploadResponse.json());case 9:uploadResult=_context4.sent;console.log(uploadResult.image);_this.setState({image:uploadResult.image});case 12:_context4.next=20;break;case 14:_context4.prev=14;_context4.t0=_context4['catch'](1);console.log({uploadResponse:uploadResponse});console.log({uploadResult:uploadResult});console.log({e:_context4.t0});alert('Upload failed, sorry :(');case 20:_context4.prev=20;_this.setState({uploading:false});return _context4.finish(20);case 23:case'end':return _context4.stop();}}},null,_this2,[[1,14,20,23]]);};_this.plateRef=_this.updateRef.bind(_this,'plate');_this.messageRef=_this.updateRef.bind(_this,'message');_this.onFocus=_this.onFocus.bind(_this);_this.state={title:'Notificação',plate:'',message:'',image:null,uploading:false};return _this;}_createClass(PrivateNotifications,[{key:'onFocus',value:function onFocus(){var _state$errors=this.state.errors,errors=_state$errors===undefined?{}:_state$errors;for(var text in errors){var ref=this[text];if(ref&&ref.isFocused()){delete errors[text];}}this.setState({errors:errors});}},{key:'onChangeText',value:function onChangeText(words){var _this3=this;['plate'].map(function(text){return{text:text,ref:_this3[text]};}).forEach(function(_ref6){var text=_ref6.text,ref=_ref6.ref;if(ref&&ref.isFocused()){_this3.setState(_defineProperty({},text,words));}});['message'].map(function(text){return{text:text,ref:_this3[text]};}).forEach(function(_ref7){var text=_ref7.text,ref=_ref7.ref;if(ref&&ref.isFocused()){_this3.setState(_defineProperty({},text,words));}});}},{key:'updateRef',value:function updateRef(text,ref){this[text]=ref;}},{key:'render',value:function render(){var _this4=this;var image=this.state.image;var _state=this.state,_state$errors2=_state.errors,errors=_state$errors2===undefined?{}:_state$errors2,data=_objectWithoutProperties(_state,['errors']);var _data$plate=data.plate,plate=_data$plate===undefined?'text':_data$plate;var _data$message=data.message,message=_data$message===undefined?'text':_data$message;return _react2.default.createElement(_reactNative.ScrollView,null,_react2.default.createElement(_reactNative.View,{style:styles.container},_react2.default.createElement(_reactNative.Text,{style:styles.header},'Notifica\xE7\xE3o'),_react2.default.createElement(_reactNativeMaterialTextfield.TextField,{ref:this.plateRef,value:data.plate,autoCorrect:false,enablesReturnKeyAutomatically:true,onFocus:this.onFocus,onChangeText:function onChangeText(plate){return _this4.setState({plate:plate});},returnKeyType:'next',label:'Placa',tintColor:'#760f9f',underlineColorAndroid:'transparent',maxLength:8,autoCapitalize:'characters',error:errors.plate}),_react2.default.createElement(_reactNativeMaterialTextfield.TextField,{ref:this.messageRef,value:data.message,autoCorrect:false,enablesReturnKeyAutomatically:true,onFocus:this.onFocus,onChangeText:function onChangeText(message){return _this4.setState({message:message});},returnKeyType:'next',label:'Descri\xE7\xE3o',tintColor:'#760f9f',error:errors.message}),_react2.default.createElement(_reactNative.Text,{style:styles.text},'Adicionar imagem'),_react2.default.createElement(_reactNative.View,{style:styles.alternativeLayoutButtonContainer},_react2.default.createElement(_reactNative.TouchableOpacity,{style:styles.button,color:'#760f9f',onPress:this._takePhoto,containerViewStyle:{width:'40%'}},_react2.default.createElement(_reactNative.Text,{style:{color:'white'}},'Camera')),_react2.default.createElement(_reactNative.TouchableOpacity,{style:styles.button2,color:'#540b71',onPress:this._pickImage,containerViewStyle:{width:'40%'}},_react2.default.createElement(_reactNative.Text,{style:{color:'white'}},'Galeria'))),this._maybeRenderImage(),this._maybeRenderUploadingOverlay(),_react2.default.createElement(_reactNative.View,{style:styles.container1},_react2.default.createElement(_reactNative.TouchableOpacity,{style:styles.button3,color:'#760f9f',onPress:this.onPressButton,containerViewStyle:{width:'40%'}},_react2.default.createElement(_reactNative.Text,{style:{color:'white'}},'Enviar')))));}}]);return PrivateNotifications;}(_react.Component);exports.default=PrivateNotifications;function uploadImageAsync(uri){var apiUrl,uriParts,fileType,formData,options;return regeneratorRuntime.async(function uploadImageAsync$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:apiUrl=_Const.NOTIFICATIONS_API+'/notificationsimage/';uriParts=uri.split('.');fileType=uriParts[uriParts.length-1];formData=new FormData();formData.append('image',{uri:uri,name:'photo.'+fileType,type:'image/'+fileType});console.log(uri);options={method:'POST',body:formData,headers:{Accept:'application/json','Content-Type':'multipart/form-data'}};return _context5.abrupt('return',fetch(apiUrl,options));case 8:case'end':return _context5.stop();}}},null,this);}var styles=_reactNative.StyleSheet.create({container:{paddingLeft:16,paddingRight:16},text:{paddingTop:16,color:"#760f9f",fontWeight:'bold'},alternativeLayoutButtonContainer:{flexDirection:'row',justifyContent:'space-between',paddingTop:4,paddingRight:4},button:{backgroundColor:"#760f9f",borderRadius:15,height:40,width:190,flexDirection:'row',justifyContent:'center',alignItems:'center'},button2:{backgroundColor:"#540b71",borderRadius:15,height:40,width:120,flexDirection:'row',justifyContent:'center',alignItems:'center'},button3:{backgroundColor:"#760f9f",borderRadius:15,height:40,width:120,flexDirection:'row',justifyContent:'center',alignItems:'center'},container1:{paddingTop:20,flexDirection:'row',justifyContent:'center'},header:{color:"#760f9f",textAlign:'center',fontWeight:'200',fontSize:50,marginTop:25},maybeRenderUploading:{paddingTop:8,alignItems:'center',backgroundColor:'rgba(0,0,0,0.0)',justifyContent:'center'},maybeRenderContainer:{width:'100%',height:'40%',justifyContent:'center',alignItems:'center',borderRadius:3,elevation:2,marginTop:32,shadowColor:'rgba(0,0,0,1)',shadowOpacity:0.2,shadowOffset:{height:4,width:4},shadowRadius:5},maybeRenderImageContainer:{borderTopLeftRadius:3,borderTopRightRadius:3,overflow:'hidden'},maybeRenderImage:{height:250,width:250}});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIlByaXZhdGVOb3RpZmljYXRpb25zLmpzIl0sIm5hbWVzIjpbInRrIiwicmVnaXN0ZXIiLCJFeHBvIiwiUGVybWlzc2lvbnMiLCJhc2tBc3luYyIsIk5PVElGSUNBVElPTlMiLCJzdGF0dXMiLCJhbGVydCIsIk5vdGlmaWNhdGlvbnMiLCJnZXRFeHBvUHVzaFRva2VuQXN5bmMiLCJ2YWx1ZSIsImNvbnNvbGUiLCJsb2ciLCJQcml2YXRlTm90aWZpY2F0aW9ucyIsImxpc3RlbmVyIiwiYWRkTGlzdGVuZXIiLCJsaXN0ZW4iLCJwcm9wcyIsIm9yaWdpbiIsImRhdGEiLCJvblByZXNzQnV0dG9uIiwiZXJyb3JzIiwidXJsIiwiTk9USUZJQ0FUSU9OU19BUEkiLCJlcnJvclBsYXRlIiwiZXJyb3JNZXNzYWdlIiwiZm9yRWFjaCIsInRleHQiLCJsZW5ndGgiLCJub3RpZmljYXRpb24iLCJKU09OIiwic3RyaW5naWZ5Iiwic2VuZGVyX2lkIiwidGl0bGUiLCJzdGF0ZSIsInBsYXRlIiwibWVzc2FnZSIsImltYWdlIiwiZmV0Y2giLCJtZXRob2QiLCJoZWFkZXJzIiwiYm9keSIsInRoZW4iLCJyZXNwb25zZSIsImpzb24iLCJqc29uUmVzcG9uc2UiLCJBbGVydCIsImNhdGNoIiwiZXJyb3IiLCJzZXRTdGF0ZSIsIl9tYXliZVJlbmRlclVwbG9hZGluZ092ZXJsYXkiLCJ1cGxvYWRpbmciLCJzdHlsZXMiLCJtYXliZVJlbmRlclVwbG9hZGluZyIsIl9tYXliZVJlbmRlckltYWdlIiwibWF5YmVSZW5kZXJDb250YWluZXIiLCJtYXliZVJlbmRlckltYWdlQ29udGFpbmVyIiwidXJpIiwibWF5YmVSZW5kZXJJbWFnZSIsIl9zaGFyZSIsIlNoYXJlIiwic2hhcmUiLCJfY29weVRvQ2xpcGJvYXJkIiwiQ2xpcGJvYXJkIiwic2V0U3RyaW5nIiwiX3Rha2VQaG90byIsIkNBTUVSQSIsImNhbWVyYVBlcm0iLCJDQU1FUkFfUk9MTCIsImNhbWVyYVJvbGxQZXJtIiwiSW1hZ2VQaWNrZXIiLCJsYXVuY2hDYW1lcmFBc3luYyIsImFsbG93c0VkaXRpbmciLCJwaWNrZXJSZXN1bHQiLCJfaGFuZGxlSW1hZ2VQaWNrZWQiLCJfcGlja0ltYWdlIiwibGF1bmNoSW1hZ2VMaWJyYXJ5QXN5bmMiLCJ1cGxvYWRSZXNwb25zZSIsInVwbG9hZFJlc3VsdCIsImNhbmNlbGxlZCIsInVwbG9hZEltYWdlQXN5bmMiLCJlIiwicGxhdGVSZWYiLCJ1cGRhdGVSZWYiLCJiaW5kIiwibWVzc2FnZVJlZiIsIm9uRm9jdXMiLCJyZWYiLCJpc0ZvY3VzZWQiLCJ3b3JkcyIsIm1hcCIsImNvbnRhaW5lciIsImhlYWRlciIsImFsdGVybmF0aXZlTGF5b3V0QnV0dG9uQ29udGFpbmVyIiwiYnV0dG9uIiwid2lkdGgiLCJjb2xvciIsImJ1dHRvbjIiLCJjb250YWluZXIxIiwiYnV0dG9uMyIsIkNvbXBvbmVudCIsImFwaVVybCIsInVyaVBhcnRzIiwic3BsaXQiLCJmaWxlVHlwZSIsImZvcm1EYXRhIiwiRm9ybURhdGEiLCJhcHBlbmQiLCJuYW1lIiwidHlwZSIsIm9wdGlvbnMiLCJBY2NlcHQiLCJTdHlsZVNoZWV0IiwiY3JlYXRlIiwicGFkZGluZ0xlZnQiLCJwYWRkaW5nUmlnaHQiLCJwYWRkaW5nVG9wIiwiZm9udFdlaWdodCIsImZsZXhEaXJlY3Rpb24iLCJqdXN0aWZ5Q29udGVudCIsImJhY2tncm91bmRDb2xvciIsImJvcmRlclJhZGl1cyIsImhlaWdodCIsImFsaWduSXRlbXMiLCJ0ZXh0QWxpZ24iLCJmb250U2l6ZSIsIm1hcmdpblRvcCIsImVsZXZhdGlvbiIsInNoYWRvd0NvbG9yIiwic2hhZG93T3BhY2l0eSIsInNoYWRvd09mZnNldCIsInNoYWRvd1JhZGl1cyIsImJvcmRlclRvcExlZnRSYWRpdXMiLCJib3JkZXJUb3BSaWdodFJhZGl1cyIsIm92ZXJmbG93Il0sIm1hcHBpbmdzIjoiaWxCQUFBLDZFQUNBLDBCQUNBLDRCLDJDQUNBLHlDQVlBLHFDLDR2Q0FFQSxHQUFJQSxHQUFKLENBQ0Es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Q3BCd0MsTUFBTyxNQURhLENBRXBCMkIsT0FBUSxLQUZZLENBR3BCSCxlQUFnQixRQUhJLENBSXBCSSxXQUFZLFFBSlEsQ0FLcEJGLGFBQWMsQ0FMTSxDQU1wQk0sVUFBVyxDQU5TLENBT3BCRCxVQUFXLEVBUFMsQ0FRcEJFLFlBQWEsZUFSTyxDQVNwQkMsY0FBZSxHQVRLLENBVXBCQyxhQUFjLENBQ1pSLE9BQVEsQ0FESSxDQUVaM0IsTUFBTyxDQUZLLENBVk0sQ0FjcEJvQyxhQUFjLENBZE0sQ0E3RFMsQ0E2RS9CM0UsMEJBQTJCLENBQ3pCNEUsb0JBQXFCLENBREksQ0FFekJDLHFCQUFzQixDQUZHLENBR3pCQyxTQUFVLFFBSGUsQ0E3RUksQ0FrRi9CNUUsaUJBQWtCLENBQ2hCZ0UsT0FBUSxHQURRLENBRWhCM0IsTUFBTyxHQUZTLENBbEZhLENBQWxCLENBQWYiLCJmaWxlIjoiUHJpdmF0ZU5vdGlmaWNhdGlvbnMuanMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBUZXh0RmllbGQgfSBmcm9tICdyZWFjdC1uYXRpdmUtbWF0ZXJpYWwtdGV4dGZpZWxkJztcbmltcG9ydCB7IENvbnN0YW50cywgSW1hZ2VQaWNrZXIsIFBlcm1pc3Npb25zIH0gZnJvbSAnZXhwbyc7XG5pbXBvcnQgUmVhY3QsIHsgQ29tcG9uZW50IH0gZnJvbSAncmVhY3QnO1xuaW1wb3J0IHtcbiAgQWN0aXZpdHlJbmRpY2F0b3IsXG4gIFZpZXcsXG4gIFRleHQsXG4gIFN0eWxlU2hlZXQsXG4gIFNjcm9sbFZpZXcsXG4gIFRleHRJbnB1dCxcbiAgVG91Y2hhYmxlT3BhY2l0eSxcbiAgQnV0dG9uLFxuICBBbGVydCxcbiAgSW1hZ2Vcbn0gZnJvbSAncmVhY3QtbmF0aXZlJztcbmltcG9ydCB7IE5PVElGSUNBVElPTlNfQVBJIH0gZnJvbSAnLi4vY29uc3QvQ29uc3QnXG5cbnZhciB0a1xuYXN5bmMgZnVuY3Rpb24gcmVnaXN0ZXIoKSB7XG4gIGNvbnN0IHsgc3RhdHVzIH0gPSBhd2FpdCBFeHBvLlBlcm1pc3Npb25zLmFza0FzeW5jKFxuICAgIEV4cG8uUGVybWlzc2lvbnMuTk9USUZJQ0FUSU9OU1xuICApO1xuICBpZiAoc3RhdHVzICE9ICdncmFudGVkJykge1xuICAgIGFsZXJ0KCdZb3UgbmVlZCB0byBlbmFibGUgcGVybWlzc2lvbnMgaW4gc2V0dGluZ3MnKTtcbiAgICByZXR1cm47XG4gIH1cblxuICBjb25zdCB2YWx1ZSA9IGF3YWl0IEV4cG8uTm90aWZpY2F0aW9ucy5nZXRFeHBvUHVzaFRva2VuQXN5bmMoKTtcbiAgdGsgPSB2YWx1ZTtcbiAgY29uc29sZS5sb2coc3RhdHVzLCB2YWx1ZSk7XG59XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFByaXZhdGVOb3RpZmljYXRpb25zIGV4dGVuZHMgQ29tcG9uZW50IHtcbiAgY29tcG9uZW50V2lsbE1vdW50KCkge1xuICAgIHJlZ2lzdGVyKCk7XG4gICAgdGhpcy5saXN0ZW5lciA9IEV4cG8uTm90aWZpY2F0aW9ucy5hZGRMaXN0ZW5lcih0aGlzLmxpc3Rlbik7XG4gIH1cbiAgY29tcG9uZW50V2lsbFVubW91bnQoKSB7XG4gICAgdGhpcy5saXN0ZW5lciAmJiBFeHBvLk5vdGlmaWNhdGlvbnMuYWRkTGlzdGVuZXIodGhpcy5saXN0ZW4pO1xuICB9XG5cbiAgbGlzdGVuID0gKHsgb3JpZ2luLCBkYXRhIH0pID0+IHtcbiAgICBjb25zb2xlLmxvZygnY29vbCBkYXRhJywgb3JpZ2luLCBkYXRhKTtcbiAgfVxuXG4gIGNvbnN0cnVjdG9yKHByb3BzKSB7XG4gICAgc3VwZXIocHJvcHMpO1xuXG4gICAgdGhpcy5wbGF0ZVJlZiA9IHRoaXMudXBkYXRlUmVmLmJpbmQodGhpcywgJ3BsYXRlJyk7XG4gICAgdGhpcy5tZXNzYWdlUmVmID0gdGhpcy51cGRhdGVSZWYuYmluZCh0aGlzLCAnbWVzc2FnZScpO1xuICAgIHRoaXMub25Gb2N1cyA9IHRoaXMub25Gb2N1cy5iaW5kKHRoaXMpO1xuXG4gICAgdGhpcy5zdGF0ZSA9IHtcbiAgICAgIHRpdGxlOiAnTm90aWZpY2HDp8OjbycsXG4gICAgICBwbGF0ZTogJycsXG4gICAgICBtZXNzYWdlOiAnJyxcbiAgICAgIGltYWdlOiBudWxsLFxuICAgICAgdXBsb2FkaW5nOiBmYWxzZSxcbiAgICB9XG4gIH1cbiAgIFxuICBvbkZvY3VzKCkge1xuICAgIGxldCB7IGVycm9ycyA9IHt9IH0gPSB0aGlzLnN0YXRlO1xuXG4gICAgZm9yIChsZXQgdGV4dCBpbiBlcnJvcnMpIHtcbiAgICAgIGxldCByZWYgPSB0aGlzW3RleHRdO1xuXG4gICAgICBpZiAocmVmICYmIHJlZi5pc0ZvY3VzZWQoKSkge1xuICAgICAgICBkZWxldGUgZXJyb3JzW3RleHRdO1xuICAgICAgfVxuICAgIH1cblxuICAgIHRoaXMuc2V0U3RhdGUoeyBlcnJvcnMgfSk7XG4gIH1cblxuICBvbkNoYW5nZVRleHQod29yZHMpIHtcbiAgICBbJ3BsYXRlJ11cbiAgICAubWFwKCh0ZXh0KSA9PiAoeyB0ZXh0LCByZWY6IHRoaXNbdGV4dF0gfSkpXG4gICAgLmZvckVhY2goKHsgdGV4dCwgcmVmIH0pID0+IHtcbiAgICAgIGlmIChyZWYgJiYgcmVmLmlzRm9jdXNlZCgpKSB7XG4gICAgICAgIHRoaXMuc2V0U3RhdGUoeyBbdGV4dF06IHdvcmRzIH0pO1xuICAgICAgfVxuICAgIH0pO1xuICAgIFsnbWVzc2FnZSddXG4gICAgLm1hcCgodGV4dCkgPT4gKHsgdGV4dCwgcmVmOiB0aGlzW3RleHRdIH0pKVxuICAgIC5mb3JFYWNoKCh7IHRleHQsIHJlZiB9KSA9PiB7XG4gICAgICBpZiAocmVmICYmIHJlZi5pc0ZvY3VzZWQoKSkge1xuICAgICAgICB0aGlzLnNldFN0YXRlKHsgW3RleHRdOiB3b3JkcyB9KTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfVxuXG4gIC8vIG9uU3VibWl0Rmlyc3ROYW1lKCkge1xuICAvLyAgIHRoaXMubGFzdG5hbWUuZm9jdXMoKTtcbiAgLy8gfVxuXG4gIG9uUHJlc3NCdXR0b24gPSAoKSA9PiB7XG4gICAgbGV0IGVycm9ycyA9IHt9O1xuICAgIGNvbnN0IHVybCA9IE5PVElGSUNBVElPTlNfQVBJICsgJy9zZW5kX3B1c2hfbWVzc2FnZS8nIC8vZnVuY3Rpb24gc2VuZF9wdXNoX21lc3NhZ2UgdXJsXG4gICAgbGV0IGVycm9yUGxhdGUgPSBmYWxzZTtcbiAgICBsZXQgZXJyb3JNZXNzYWdlID0gZmFsc2U7XG5cbiAgICBbJ3BsYXRlJ11cbiAgICAuZm9yRWFjaCgodGV4dCkgPT4ge1xuICAgICAgbGV0IHZhbHVlID0gdGhpc1t0ZXh0XS52YWx1ZSgpO1xuXG4gICAgICBpZiAoIXZhbHVlKSB7XG4gICAgICAgIGVycm9yc1t0ZXh0XSA9ICdDYW1wbyBvYnJpZ2F0w7NyaW8uJztcbiAgICAgICAgZXJyb3JQbGF0ZSA9IHRydWU7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBpZiAoJ3BsYXRlJyA9PT0gdGV4dCAmJiB2YWx1ZS5sZW5ndGggPCA4KSB7XG4gICAgICAgICAgZXJyb3JzW3RleHRdID0gJ1BsYWNhIGludsOhbGlkYS4gRXguOkFBQS0wMDAwJztcbiAgICAgICAgICBlcnJvclBsYXRlID0gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0pO1xuXG4gICAgWydtZXNzYWdlJ11cbiAgICAuZm9yRWFjaCgodGV4dCkgPT4ge1xuICAgICAgbGV0IHZhbHVlID0gdGhpc1t0ZXh0XS52YWx1ZSgpO1xuXG4gICAgICBpZiAoIXZhbHVlKSB7XG4gICAgICAgIGVycm9yc1t0ZXh0XSA9ICdDYW1wbyBvYnJpZ2F0w7NyaW8uJztcbiAgICAgICAgZXJyb3JNZXNzYWdlID0gdHJ1ZTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGlmICgnbWVzc2FnZScgPT09IHRleHQgJiYgdmFsdWUubGVuZ3RoIDwgNSkge1xuICAgICAgICAgIGVycm9yc1t0ZXh0XSA9ICdGb3JuZcOnYSBtYWlzIGRldGFsaGVzIGRvIG9jb3JyaWRvLic7XG4gICAgICAgICAgZXJyb3JNZXNzYWdlID0gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0pO1xuXG4gICAgaWYgKGVycm9yUGxhdGUgPT0gZmFsc2UgJiYgZXJyb3JNZXNzYWdlID09IGZhbHNlKSB7XG4gICAgICBsZXQgbm90aWZpY2F0aW9uID0gSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICBzZW5kZXJfaWQ6IHRrLFxuICAgICAgICB0aXRsZTogdGhpcy5zdGF0ZS50aXRsZSxcbiAgICAgICAgcGxhdGU6IHRoaXMuc3RhdGUucGxhdGUsXG4gICAgICAgIG1lc3NhZ2U6IHRoaXMuc3RhdGUubWVzc2FnZSxcbiAgICAgICAgaW1hZ2U6IHRoaXMuc3RhdGUuaW1hZ2VcbiAgICAgIH0pXG5cbiAgICAgIGNvbnNvbGUubG9nKG5vdGlmaWNhdGlvbik7XG5cbiAgICAgIGZldGNoKHVybCwge1xuICAgICAgICBtZXRob2Q6ICdQT1NUJyxcbiAgICAgICAgaGVhZGVyczoge1xuICAgICAgICAgICdBY2NlcHQnOiAnYXBwbGljYXRpb24vanNvbicsXG4gICAgICAgICAgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJyxcbiAgICAgICAgfSxcbiAgICAgICAgYm9keTogbm90aWZpY2F0aW9uXG4gICAgICB9KS50aGVuKHJlc3BvbnNlID0+IHsgcmV0dXJuIHJlc3BvbnNlLmpzb24oKSB9XG4gICAgICApLnRoZW4oanNvblJlc3BvbnNlID0+IHtcbiAgICAgICAgY29uc29sZS5sb2coanNvblJlc3BvbnNlKTtcbiAgICAgICAgQWxlcnQuYWxlcnQoXCJOb3RpZmljYcOnw6NvIGVudmlhZGEhXCIpXG4gICAgICB9ICAgICAgXG4gICAgICApLmNhdGNoKGVycm9yID0+IHtcbiAgICAgICAgY29uc29sZS5sb2coZXJyb3IpXG4gICAgICAgIEFsZXJ0LmFsZXJ0KFwiUGxhY2EgbsOjbyBleGlzdGUhXCIpXG4gICAgICB9KVxuICAgIH1cbiAgICB0aGlzLnNldFN0YXRlKHsgZXJyb3JzIH0pO1xuICB9XG5cbiAgdXBkYXRlUmVmKHRleHQsIHJlZikge1xuICAgIHRoaXNbdGV4dF0gPSByZWY7XG4gIH1cblxuICByZW5kZXIoKSB7XG4gICAgbGV0IHsgaW1hZ2UgfSA9IHRoaXMuc3RhdGU7XG4gICAgbGV0IHsgZXJyb3JzID0ge30sIC4uLmRhdGF9ID0gdGhpcy5zdGF0ZTtcbiAgICBsZXQge3BsYXRlID0gJ3RleHQnfSA9IGRhdGE7XG4gICAgbGV0IHttZXNzYWdlID0gJ3RleHQnfSA9IGRhdGE7XG5cbiAgICByZXR1cm4gKFxuICAgICAgPFNjcm9sbFZpZXc+XG4gICAgICAgIDxWaWV3IHN0eWxlPXtzdHlsZXMuY29udGFpbmVyfT5cbiAgICAgICAgICA8VGV4dCBzdHlsZT17c3R5bGVzLmhlYWRlcn0+Tm90aWZpY2HDp8OjbzwvVGV4dD5cbiAgICAgICAgICA8VGV4dEZpZWxkXG4gICAgICAgICAgICByZWY9e3RoaXMucGxhdGVSZWZ9XG4gICAgICAgICAgICB2YWx1ZT17ZGF0YS5wbGF0ZX1cbiAgICAgICAgICAgIGF1dG9Db3JyZWN0PXtmYWxzZX1cbiAgICAgICAgICAgIGVuYWJsZXNSZXR1cm5LZXlBdXRvbWF0aWNhbGx5PXt0cnVlfVxuICAgICAgICAgICAgb25Gb2N1cz17dGhpcy5vbkZvY3VzfVxuICAgICAgICAgICAgb25DaGFuZ2VUZXh0PXsgKHBsYXRlKSA9PiB0aGlzLnNldFN0YXRlKHsgcGxhdGUgfSkgfVxuICAgICAgICAgICAgLy8gb25DaGFuZ2VUZXh0PXt0aGlzLm9uQ2hhbmdlVGV4dH1cbiAgICAgICAgICAgIC8vIG9uU3VibWl0RWRpdGluZz17dGhpcy5vblN1Ym1pdFBMYXRlfVxuICAgICAgICAgICAgcmV0dXJuS2V5VHlwZT0nbmV4dCdcbiAgICAgICAgICAgIGxhYmVsPSdQbGFjYSdcbiAgICAgICAgICAgIHRpbnRDb2xvciA9IFwiIzc2MGY5ZlwiXG4gICAgICAgICAgICB1bmRlcmxpbmVDb2xvckFuZHJvaWQ9XCJ0cmFuc3BhcmVudFwiXG4gICAgICAgICAgICBtYXhMZW5ndGg9ezh9XG4gICAgICAgICAgICBhdXRvQ2FwaXRhbGl6ZT1cImNoYXJhY3RlcnNcIlxuICAgICAgICAgICAgZXJyb3I9e2Vycm9ycy5wbGF0ZX1cbiAgICAgICAgICAvPlxuICAgICAgICAgIDxUZXh0RmllbGRcbiAgICAgICAgICAgIHJlZj17dGhpcy5tZXNzYWdlUmVmfVxuICAgICAgICAgICAgdmFsdWU9e2RhdGEubWVzc2FnZX1cbiAgICAgICAgICAgIGF1dG9Db3JyZWN0PXtmYWxzZX1cbiAgICAgICAgICAgIGVuYWJsZXNSZXR1cm5LZXlBdXRvbWF0aWNhbGx5PXt0cnVlfVxuICAgICAgICAgICAgb25Gb2N1cz17dGhpcy5vbkZvY3VzfVxuICAgICAgICAgICAgb25DaGFuZ2VUZXh0PXsgKG1lc3NhZ2UpID0+IHRoaXMuc2V0U3RhdGUoeyBtZXNzYWdlIH0pIH1cbiAgICAgICAgICAgIC8vIG9uQ2hhbmdlVGV4dD17dGhpcy5vbkNoYW5nZVRleHR9XG4gICAgICAgICAgICAvLyBvblN1Ym1pdEVkaXRpbmc9e3RoaXMub25TdWJtaXRNZXNzYWdlfVxuICAgICAgICAgICAgcmV0dXJuS2V5VHlwZT0nbmV4dCdcbiAgICAgICAgICAgIGxhYmVsPSdEZXNjcmnDp8OjbydcbiAgICAgICAgICAgIHRpbnRDb2xvciA9IFwiIzc2MGY5ZlwiXG4gICAgICAgICAgICBlcnJvcj17ZXJyb3JzLm1lc3NhZ2V9XG4gICAgICAgICAgLz5cbiAgICAgICAgICA8VGV4dCBzdHlsZT17c3R5bGVzLnRleHR9PkFkaWNpb25hciBpbWFnZW08L1RleHQ+XG4gICAgICAgICAgPFZpZXcgc3R5bGU9e3N0eWxlcy5hbHRlcm5hdGl2ZUxheW91dEJ1dHRvbkNvbnRhaW5lcn0+XG4gICAgICAgICAgICA8VG91Y2hhYmxlT3BhY2l0eVxuICAgICAgICAgICAgICBzdHlsZT17c3R5bGVzLmJ1dHRvbn1cbiAgICAgICAgICAgICAgY29sb3I9XCIjNzYwZjlmXCJcbiAgICAgICAgICAgICAgb25QcmVzcz17dGhpcy5fdGFrZVBob3RvfVxuICAgICAgICAgICAgICBjb250YWluZXJWaWV3U3R5bGU9e3sgd2lkdGg6ICc0MCUnIH19XG4gICAgICAgICAgICA+XG4gICAgICAgICAgICAgIDxUZXh0IHN0eWxlPXt7IGNvbG9yOiAnd2hpdGUnIH19ID5DYW1lcmE8L1RleHQ+XG4gICAgICAgICAgICA8L1RvdWNoYWJsZU9wYWNpdHk+XG4gICAgICAgICAgICA8VG91Y2hhYmxlT3BhY2l0eVxuICAgICAgICAgICAgICBzdHlsZT17c3R5bGVzLmJ1dHRvbjJ9XG4gICAgICAgICAgICAgIGNvbG9yPVwiIzU0MGI3MVwiXG4gICAgICAgICAgICAgIG9uUHJlc3M9e3RoaXMuX3BpY2tJbWFnZX1cbiAgICAgICAgICAgICAgY29udGFpbmVyVmlld1N0eWxlPXt7IHdpZHRoOiAnNDAlJyB9fVxuICAgICAgICAgICAgPlxuICAgICAgICAgICAgICA8VGV4dCBzdHlsZT17eyBjb2xvcjogJ3doaXRlJyB9fSA+R2FsZXJpYTwvVGV4dD5cbiAgICAgICAgICAgIDwvVG91Y2hhYmxlT3BhY2l0eT5cbiAgICAgICAgICA8L1ZpZXc+XG4gICAgICAgICAge3RoaXMuX21heWJlUmVuZGVySW1hZ2UoKX1cbiAgICAgICAgICB7dGhpcy5fbWF5YmVSZW5kZXJVcGxvYWRpbmdPdmVybGF5KCl9XG4gICAgICAgICAgPFZpZXcgc3R5bGU9e3N0eWxlcy5jb250YWluZXIxfT5cbiAgICAgICAgICAgIDxUb3VjaGFibGVPcGFjaXR5XG4gICAgICAgICAgICAgIHN0eWxlPXtzdHlsZXMuYnV0dG9uM31cbiAgICAgICAgICAgICAgY29sb3I9XCIjNzYwZjlmXCJcbiAgICAgICAgICAgICAgb25QcmVzcz17dGhpcy5vblByZXNzQnV0dG9ufVxuICAgICAgICAgICAgICBjb250YWluZXJWaWV3U3R5bGU9e3sgd2lkdGg6ICc0MCUnIH19XG4gICAgICAgICAgICA+XG4gICAgICAgICAgICAgIDxUZXh0IHN0eWxlPXt7IGNvbG9yOiAnd2hpdGUnIH19ID5FbnZpYXI8L1RleHQ+XG4gICAgICAgICAgICA8L1RvdWNoYWJsZU9wYWNpdHk+XG4gICAgICAgICAgPC9WaWV3PlxuICAgICAgICA8L1ZpZXc+XG4gICAgICA8L1Njcm9sbFZpZXc+XG4gICAgKTtcbiAgfVxuXG4gIF9tYXliZVJlbmRlclVwbG9hZGluZ092ZXJsYXkgPSAoKSA9PiB7IC8vZG9uZVxuICAgIGlmICh0aGlzLnN0YXRlLnVwbG9hZGluZykge1xuICAgICAgcmV0dXJuIChcbiAgICAgICAgPFZpZXdcbiAgICAgICAgICBzdHlsZT17c3R5bGVzLm1heWJlUmVuZGVyVXBsb2FkaW5nfT5cbiAgICAgICAgICA8QWN0aXZpdHlJbmRpY2F0b3IgY29sb3I9XCIjMzEzODY5XCIgc2l6ZT1cImxhcmdlXCIgLz5cbiAgICAgICAgPC9WaWV3PlxuICAgICAgKTtcbiAgICB9XG4gIH07XG5cbiAgX21heWJlUmVuZGVySW1hZ2UgPSAoKSA9PiB7IC8vZG9uZVxuICAgIGxldCB7XG4gICAgICBpbWFnZVxuICAgIH0gPSB0aGlzLnN0YXRlO1xuXG4gICAgaWYgKCFpbWFnZSkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIC8vIG9uUHJlc3M9e3RoaXMuX2NvcHlUb0NsaXBib2FyZH1cbiAgICAvLyBvbkxvbmdQcmVzcz17dGhpcy5fc2hhcmV9XG5cbiAgICByZXR1cm4gKFxuICAgICAgPFZpZXdcbiAgICAgICAgc3R5bGU9e3N0eWxlcy5tYXliZVJlbmRlckNvbnRhaW5lcn0+XG4gICAgICAgIDxWaWV3XG4gICAgICAgICAgc3R5bGU9e3N0eWxlcy5tYXliZVJlbmRlckltYWdlQ29udGFpbmVyfT5cbiAgICAgICAgICA8SW1hZ2Ugc291cmNlPXt7IHVyaTogaW1hZ2UgfX0gc3R5bGU9e3N0eWxlcy5tYXliZVJlbmRlckltYWdlfSAvPlxuICAgICAgICA8L1ZpZXc+XG4gICAgICA8L1ZpZXc+XG4gICAgKTtcbiAgfTtcblxuICBfc2hhcmUgPSAoKSA9PiB7XG4gICAgU2hhcmUuc2hhcmUoe1xuICAgICAgbWVzc2FnZTogdGhpcy5zdGF0ZS5pbWFnZSxcbiAgICAgIHRpdGxlOiAnQ2hlY2sgb3V0IHRoaXMgcGhvdG8nLFxuICAgICAgdXJsOiB0aGlzLnN0YXRlLmltYWdlLFxuICAgIH0pO1xuICB9O1xuXG4gIF9jb3B5VG9DbGlwYm9hcmQgPSAoKSA9PiB7XG4gICAgQ2xpcGJvYXJkLnNldFN0cmluZyh0aGlzLnN0YXRlLmltYWdlKTtcbiAgICBhbGVydCgnQ29waWVkIGltYWdlIFVSTCB0byBjbGlwYm9hcmQnKTtcbiAgfTtcblxuICBfdGFrZVBob3RvID0gYXN5bmMgKCkgPT4geyAvL0RvbmVcbiAgICBjb25zdCB7XG4gICAgICBzdGF0dXM6IGNhbWVyYVBlcm1cbiAgICB9ID0gYXdhaXQgUGVybWlzc2lvbnMuYXNrQXN5bmMoUGVybWlzc2lvbnMuQ0FNRVJBKTtcblxuICAgIGNvbnN0IHtcbiAgICAgIHN0YXR1czogY2FtZXJhUm9sbFBlcm1cbiAgICB9ID0gYXdhaXQgUGVybWlzc2lvbnMuYXNrQXN5bmMoUGVybWlzc2lvbnMuQ0FNRVJBX1JPTEwpO1xuXG4gIC8vIG9ubHkgaWYgdXNlciBhbGxvd3MgcGVybWlzc2lvbiB0byBjYW1lcmEgQU5EIGNhbWVyYSByb2xsXG4gICAgaWYgKGNhbWVyYVBlcm0gPT09ICdncmFudGVkJyAmJiBjYW1lcmFSb2xsUGVybSA9PT0gJ2dyYW50ZWQnKSB7XG4gICAgICBsZXQgcGlja2VyUmVzdWx0ID0gYXdhaXQgSW1hZ2VQaWNrZXIubGF1bmNoQ2FtZXJhQXN5bmMoe1xuICAgICAgICBhbGxvd3NFZGl0aW5nOiB0cnVlLFxuICAgICAgfSk7XG5cbiAgICAgIHRoaXMuX2hhbmRsZUltYWdlUGlja2VkKHBpY2tlclJlc3VsdCk7XG4gICAgfVxuICB9O1xuXG4gIF9waWNrSW1hZ2UgPSBhc3luYyAoKSA9PiB7XG4gICAgY29uc3Qge1xuICAgICAgc3RhdHVzOiBjYW1lcmFSb2xsUGVybVxuICAgIH0gPSBhd2FpdCBQZXJtaXNzaW9ucy5hc2tBc3luYyhQZXJtaXNzaW9ucy5DQU1FUkFfUk9MTCk7XG5cbiAgLy8gb25seSBpZiB1c2VyIGFsbG93cyBwZXJtaXNzaW9uIHRvIGNhbWVyYSByb2xsXG4gICAgaWYgKGNhbWVyYVJvbGxQZXJtID09PSAnZ3JhbnRlZCcpIHtcbiAgICAgIGxldCBwaWNrZXJSZXN1bHQgPSBhd2FpdCBJbWFnZVBpY2tlci5sYXVuY2hJbWFnZUxpYnJhcnlBc3luYyh7XG4gICAgICAgIGFsbG93c0VkaXRpbmc6IHRydWUsXG5cbiAgICAgIH0pO1xuXG4gICAgICB0aGlzLl9oYW5kbGVJbWFnZVBpY2tlZChwaWNrZXJSZXN1bHQpO1xuICAgIH1cbiAgfTtcblxuICBfaGFuZGxlSW1hZ2VQaWNrZWQgPSBhc3luYyBwaWNrZXJSZXN1bHQgPT4ge1xuICAgIGxldCB1cGxvYWRSZXNwb25zZSwgdXBsb2FkUmVzdWx0O1xuXG4gICAgdHJ5IHtcbiAgICAgIHRoaXMuc2V0U3RhdGUoe1xuICAgICAgICB1cGxvYWRpbmc6IHRydWVcbiAgICAgIH0pO1xuXG4gICAgICBpZiAoIXBpY2tlclJlc3VsdC5jYW5jZWxsZWQpIHtcbiAgICAgICAgdXBsb2FkUmVzcG9uc2UgPSBhd2FpdCB1cGxvYWRJbWFnZUFzeW5jKHBpY2tlclJlc3VsdC51cmkpO1xuICAgICAgICB1cGxvYWRSZXN1bHQgPSBhd2FpdCB1cGxvYWRSZXNwb25zZS5qc29uKCk7XG5cbiAgICAgICAgY29uc29sZS5sb2codXBsb2FkUmVzdWx0LmltYWdlKVxuXG4gICAgICAgIHRoaXMuc2V0U3RhdGUoe1xuICAgICAgICAgIGltYWdlOiB1cGxvYWRSZXN1bHQuaW1hZ2VcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgfSBjYXRjaCAoZSkge1xuICAgICAgY29uc29sZS5sb2coeyB1cGxvYWRSZXNwb25zZSB9KTtcbiAgICAgIGNvbnNvbGUubG9nKHsgdXBsb2FkUmVzdWx0IH0pO1xuICAgICAgY29uc29sZS5sb2coeyBlIH0pO1xuICAgICAgYWxlcnQoJ1VwbG9hZCBmYWlsZWQsIHNvcnJ5IDooJyk7XG4gICAgfSBmaW5hbGx5IHtcbiAgICAgIHRoaXMuc2V0U3RhdGUoe1xuICAgICAgdXBsb2FkaW5nOiBmYWxzZVxuICAgICAgfSk7XG4gICAgfVxuICB9O1xufVxuXG4gIGFzeW5jIGZ1bmN0aW9uIHVwbG9hZEltYWdlQXN5bmModXJpKSB7XG4gICAgbGV0IGFwaVVybCA9IE5PVElGSUNBVElPTlNfQVBJICsgJy9ub3RpZmljYXRpb25zaW1hZ2UvJztcblxuICAgIC8vIE5vdGU6XG4gICAgLy8gVW5jb21tZW50IHRoaXMgaWYgeW91IHdhbnQgdG8gZXhwZXJpbWVudCB3aXRoIGxvY2FsIHNlcnZlclxuICAgIC8vXG4gICAgLy8gaWYgKENvbnN0YW50cy5pc0RldmljZSkge1xuICAgIC8vICAgYXBpVXJsID0gYGh0dHBzOi8veW91ci1uZ3Jvay1zdWJkb21haW4ubmdyb2suaW8vdXBsb2FkYDtcbiAgICAvLyB9IGVsc2Uge1xuICAgIC8vICAgYXBpVXJsID0gYGh0dHA6Ly9sb2NhbGhvc3Q6MzAwMC91cGxvYWRgXG4gICAgLy8gfVxuXG4gICAgbGV0IHVyaVBhcnRzID0gdXJpLnNwbGl0KCcuJyk7XG4gICAgbGV0IGZpbGVUeXBlID0gdXJpUGFydHNbdXJpUGFydHMubGVuZ3RoIC0gMV07XG5cbiAgICBsZXQgZm9ybURhdGEgPSBuZXcgRm9ybURhdGEoKTtcbiAgICBmb3JtRGF0YS5hcHBlbmQoJ2ltYWdlJywge1xuICAgICAgdXJpLFxuICAgICAgbmFtZTogYHBob3RvLiR7ZmlsZVR5cGV9YCxcbiAgICAgIHR5cGU6IGBpbWFnZS8ke2ZpbGVUeXBlfWAsXG4gICAgfSk7XG5cbiAgICBjb25zb2xlLmxvZyh1cmkpXG5cbiAgICBsZXQgb3B0aW9ucyA9IHtcbiAgICAgIG1ldGhvZDogJ1BPU1QnLFxuICAgICAgYm9keTogZm9ybURhdGEsXG4gICAgICBoZWFkZXJzOiB7XG4gICAgICAgIEFjY2VwdDogJ2FwcGxpY2F0aW9uL2pzb24nLFxuICAgICAgICAnQ29udGVudC1UeXBlJzogJ211bHRpcGFydC9mb3JtLWRhdGEnLFxuICAgICAgfSxcbiAgICB9O1xuICAgIHJldHVybiBmZXRjaChhcGlVcmwsIG9wdGlvbnMpO1xuICB9XG5cbmNvbnN0IHN0eWxlcyA9IFN0eWxlU2hlZXQuY3JlYXRlKHtcbiAgY29udGFpbmVyOiB7XG4gICAgcGFkZGluZ0xlZnQ6IDE2LFxuICAgIHBhZGRpbmdSaWdodDogMTZcbiAgfSxcbiAgdGV4dDoge1xuICAgIHBhZGRpbmdUb3A6IDE2LFxuICAgIGNvbG9yOiBcIiM3NjBmOWZcIixcbiAgICBmb250V2VpZ2h0OiAnYm9sZCcsXG4gIH0sXG4gIGFsdGVybmF0aXZlTGF5b3V0QnV0dG9uQ29udGFpbmVyOiB7XG4gICAgZmxleERpcmVjdGlvbjogJ3JvdycsXG4gICAganVzdGlmeUNvbnRlbnQ6ICdzcGFjZS1iZXR3ZWVuJyxcbiAgICBwYWRkaW5nVG9wOiA0LFxuICAgIHBhZGRpbmdSaWdodDogNCxcbiAgfSxcbiAgYnV0dG9uOiB7XG4gICAgYmFja2dyb3VuZENvbG9yOiBcIiM3NjBmOWZcIixcbiAgICBib3JkZXJSYWRpdXM6IDE1LFxuICAgIGhlaWdodDogNDAsXG4gICAgd2lkdGg6IDE5MCxcbiAgICBmbGV4RGlyZWN0aW9uOiAncm93JyxcbiAgICBqdXN0aWZ5Q29udGVudDogJ2NlbnRlcicsXG4gICAgYWxpZ25JdGVtczogJ2NlbnRlcidcbiAgfSxcbiAgYnV0dG9uMjoge1xuICAgIGJhY2tncm91bmRDb2xvcjogXCIjNTQwYjcxXCIsXG4gICAgYm9yZGVyUmFkaXVzOiAxNSxcbiAgICBoZWlnaHQ6IDQwLFxuICAgIHdpZHRoOiAxMjAsXG4gICAgZmxleERpcmVjdGlvbjogJ3JvdycsXG4gICAganVzdGlmeUNvbnRlbnQ6ICdjZW50ZXInLFxuICAgIGFsaWduSXRlbXM6ICdjZW50ZXInXG4gIH0sXG4gIGJ1dHRvbjM6IHtcbiAgICBiYWNrZ3JvdW5kQ29sb3I6IFwiIzc2MGY5ZlwiLFxuICAgIGJvcmRlclJhZGl1czogMTUsXG4gICAgaGVpZ2h0OiA0MCxcbiAgICB3aWR0aDogMTIwLFxuICAgIGZsZXhEaXJlY3Rpb246ICdyb3cnLFxuICAgIGp1c3RpZnlDb250ZW50OiAnY2VudGVyJyxcbiAgICBhbGlnbkl0ZW1zOiAnY2VudGVyJ1xuICB9LFxuICBjb250YWluZXIxOiB7XG4gICAgcGFkZGluZ1RvcDogMjAsXG4gICAgZmxleERpcmVjdGlvbjogJ3JvdycsXG4gICAganVzdGlmeUNvbnRlbnQ6ICdjZW50ZXInXG4gIH0sXG4gIGhlYWRlcjoge1xuICAgIGNvbG9yOiBcIiM3NjBmOWZcIixcbiAgICB0ZXh0QWxpZ246ICdjZW50ZXInLFxuICAgIGZvbnRXZWlnaHQ6ICcyMDAnLFxuICAgIGZvbnRTaXplOiA1MCxcbiAgICBtYXJnaW5Ub3A6IDI1XG4gIH0sXG4gIG1heWJlUmVuZGVyVXBsb2FkaW5nOiB7XG4gICAgcGFkZGluZ1RvcDogOCxcbiAgICBhbGlnbkl0ZW1zOiAnY2VudGVyJyxcbiAgICBiYWNrZ3JvdW5kQ29sb3I6ICdyZ2JhKDAsMCwwLDAuMCknLFxuICAgIGp1c3RpZnlDb250ZW50OiAnY2VudGVyJyxcbiAgfSxcbiAgbWF5YmVSZW5kZXJDb250YWluZXI6IHtcbiAgICB3aWR0aDogJzEwMCUnLFxuICAgIGhlaWdodDogJzQwJScsXG4gICAganVzdGlmeUNvbnRlbnQ6ICdjZW50ZXInLFxuICAgIGFsaWduSXRlbXM6ICdjZW50ZXInLFxuICAgIGJvcmRlclJhZGl1czogMyxcbiAgICBlbGV2YXRpb246IDIsXG4gICAgbWFyZ2luVG9wOiAzMixcbiAgICBzaGFkb3dDb2xvcjogJ3JnYmEoMCwwLDAsMSknLFxuICAgIHNoYWRvd09wYWNpdHk6IDAuMixcbiAgICBzaGFkb3dPZmZzZXQ6IHtcbiAgICAgIGhlaWdodDogNCxcbiAgICAgIHdpZHRoOiA0LFxuICAgIH0sXG4gICAgc2hhZG93UmFkaXVzOiA1XG4gIH0sXG4gIG1heWJlUmVuZGVySW1hZ2VDb250YWluZXI6IHtcbiAgICBib3JkZXJUb3BMZWZ0UmFkaXVzOiAzLFxuICAgIGJvcmRlclRvcFJpZ2h0UmFkaXVzOiAzLFxuICAgIG92ZXJmbG93OiAnaGlkZGVuJyxcbiAgfSxcbiAgbWF5YmVSZW5kZXJJbWFnZToge1xuICAgIGhlaWdodDogMjUwLFxuICAgIHdpZHRoOiAyNTAsXG4gIH1cbn0pO1xuIl19