{"version":3,"sources":["PrivateNotifications.js"],"names":["tk","register","Expo","Permissions","askAsync","NOTIFICATIONS","status","alert","Notifications","getExpoPushTokenAsync","value","console","log","PrivateNotifications","listener","addListener","listen","props","origin","data","onPressButton","errors","url","NOTIFICATIONS_API","errorPlate","errorMessage","forEach","text","length","notification","JSON","stringify","sender_id","title","state","plate","message","image","fetch","method","headers","body","then","response","json","jsonResponse","Alert","catch","error","setState","_maybeRenderUploadingOverlay","uploading","styles","maybeRenderUploading","_maybeRenderImage","maybeRenderContainer","maybeRenderImageContainer","uri","maybeRenderImage","_share","Share","share","_copyToClipboard","Clipboard","setString","_takePhoto","CAMERA","cameraPerm","CAMERA_ROLL","cameraRollPerm","ImagePicker","launchCameraAsync","allowsEditing","pickerResult","_handleImagePicked","_pickImage","launchImageLibraryAsync","uploadResponse","uploadResult","cancelled","uploadImageAsync","e","plateRef","updateRef","bind","messageRef","onFocus","ref","isFocused","words","map","container","header","alternativeLayoutButtonContainer","button","width","color","button2","container1","button3","Component","apiUrl","uriParts","split","fileType","formData","FormData","append","name","type","options","Accept","StyleSheet","create","paddingLeft","paddingRight","paddingTop","fontWeight","flexDirection","justifyContent","backgroundColor","borderRadius","height","alignItems","textAlign","fontSize","marginTop","elevation","shadowColor","shadowOpacity","shadowOffset","shadowRadius","borderTopLeftRadius","borderTopRightRadius","overflow"],"mappings":"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","file":"PrivateNotifications.js","sourcesContent":["import { TextField } from 'react-native-material-textfield';\nimport { Constants, ImagePicker, Permissions } from 'expo';\nimport React, { Component } from 'react';\nimport {\n  ActivityIndicator,\n  View,\n  Text,\n  StyleSheet,\n  ScrollView,\n  TextInput,\n  TouchableOpacity,\n  Button,\n  Alert,\n  Image\n} from 'react-native';\nimport { NOTIFICATIONS_API } from '../const/Const'\n\nvar tk\nasync function register() {\n  const { status } = await Expo.Permissions.askAsync(\n    Expo.Permissions.NOTIFICATIONS\n  );\n  if (status != 'granted') {\n    alert('You need to enable permissions in settings');\n    return;\n  }\n\n  const value = await Expo.Notifications.getExpoPushTokenAsync();\n  tk = value;\n  console.log(status, value);\n}\n\nexport default class PrivateNotifications extends Component {\n  componentWillMount() {\n    register();\n    this.listener = Expo.Notifications.addListener(this.listen);\n  }\n  componentWillUnmount() {\n    this.listener && Expo.Notifications.addListener(this.listen);\n  }\n\n  listen = ({ origin, data }) => {\n    console.log('cool data', origin, data);\n  }\n\n  constructor(props) {\n    super(props);\n\n    this.plateRef = this.updateRef.bind(this, 'plate');\n    this.messageRef = this.updateRef.bind(this, 'message');\n    this.onFocus = this.onFocus.bind(this);\n\n    this.state = {\n      title: 'Notificação',\n      plate: '',\n      message: '',\n      image: null,\n      uploading: false,\n    }\n  }\n   \n  onFocus() {\n    let { errors = {} } = this.state;\n\n    for (let text in errors) {\n      let ref = this[text];\n\n      if (ref && ref.isFocused()) {\n        delete errors[text];\n      }\n    }\n\n    this.setState({ errors });\n  }\n\n  onChangeText(words) {\n    ['plate']\n    .map((text) => ({ text, ref: this[text] }))\n    .forEach(({ text, ref }) => {\n      if (ref && ref.isFocused()) {\n        this.setState({ [text]: words });\n      }\n    });\n    ['message']\n    .map((text) => ({ text, ref: this[text] }))\n    .forEach(({ text, ref }) => {\n      if (ref && ref.isFocused()) {\n        this.setState({ [text]: words });\n      }\n    });\n  }\n\n  // onSubmitFirstName() {\n  //   this.lastname.focus();\n  // }\n\n  onPressButton = () => {\n    let errors = {};\n    const url = NOTIFICATIONS_API + '/send_push_message/' //function send_push_message url\n    let errorPlate = false;\n    let errorMessage = false;\n\n    ['plate']\n    .forEach((text) => {\n      let value = this[text].value();\n\n      if (!value) {\n        errors[text] = 'Campo obrigatório.';\n        errorPlate = true;\n      } else {\n        if ('plate' === text && value.length < 8) {\n          errors[text] = 'Placa inválida. Ex.:AAA-0000';\n          errorPlate = true;\n        }\n      }\n    });\n\n    ['message']\n    .forEach((text) => {\n      let value = this[text].value();\n\n      if (!value) {\n        errors[text] = 'Campo obrigatório.';\n        errorMessage = true;\n      } else {\n        if ('message' === text && value.length < 5) {\n          errors[text] = 'Forneça mais detalhes do ocorrido.';\n          errorMessage = true;\n        }\n      }\n    });\n\n    if (errorPlate == false && errorMessage == false) {\n      let notification = JSON.stringify({\n        sender_id: tk,\n        title: this.state.title,\n        plate: this.state.plate,\n        message: this.state.message,\n        image: this.state.image\n      })\n\n      console.log(notification);\n\n      fetch(url, {\n        method: 'POST',\n        headers: {\n          'Accept': 'application/json',\n          'Content-Type': 'application/json',\n        },\n        body: notification\n      }).then(response => { return response.json() }\n      ).then(jsonResponse => {\n        console.log(jsonResponse);\n        Alert.alert(\"Notificação enviada!\")\n      }      \n      ).catch(error => {\n        console.log(error)\n        Alert.alert(\"Placa não existe!\")\n      })\n    }\n    this.setState({ errors });\n  }\n\n  updateRef(text, ref) {\n    this[text] = ref;\n  }\n\n  render() {\n    let { image } = this.state;\n    let { errors = {}, ...data} = this.state;\n    let {plate = 'text'} = data;\n    let {message = 'text'} = data;\n\n    return (\n      <ScrollView>\n        <View style={styles.container}>\n          <Text style={styles.header}>Notificação</Text>\n          <TextField\n            ref={this.plateRef}\n            value={data.plate}\n            autoCorrect={false}\n            enablesReturnKeyAutomatically={true}\n            onFocus={this.onFocus}\n            onChangeText={ (plate) => this.setState({ plate }) }\n            // onChangeText={this.onChangeText}\n            // onSubmitEditing={this.onSubmitPLate}\n            returnKeyType='next'\n            label='Placa'\n            tintColor = \"#760f9f\"\n            underlineColorAndroid=\"transparent\"\n            maxLength={8}\n            autoCapitalize=\"characters\"\n            error={errors.plate}\n          />\n          <TextField\n            ref={this.messageRef}\n            value={data.message}\n            autoCorrect={false}\n            enablesReturnKeyAutomatically={true}\n            onFocus={this.onFocus}\n            onChangeText={ (message) => this.setState({ message }) }\n            // onChangeText={this.onChangeText}\n            // onSubmitEditing={this.onSubmitMessage}\n            returnKeyType='next'\n            label='Descrição'\n            tintColor = \"#760f9f\"\n            error={errors.message}\n          />\n          <Text style={styles.text}>Adicionar imagem</Text>\n          <View style={styles.alternativeLayoutButtonContainer}>\n            <TouchableOpacity\n              style={styles.button}\n              color=\"#760f9f\"\n              onPress={this._takePhoto}\n              containerViewStyle={{ width: '40%' }}\n            >\n              <Text style={{ color: 'white' }} >Camera</Text>\n            </TouchableOpacity>\n            <TouchableOpacity\n              style={styles.button2}\n              color=\"#540b71\"\n              onPress={this._pickImage}\n              containerViewStyle={{ width: '40%' }}\n            >\n              <Text style={{ color: 'white' }} >Galeria</Text>\n            </TouchableOpacity>\n          </View>\n          {this._maybeRenderImage()}\n          {this._maybeRenderUploadingOverlay()}\n          <View style={styles.container1}>\n            <TouchableOpacity\n              style={styles.button3}\n              color=\"#760f9f\"\n              onPress={this.onPressButton}\n              containerViewStyle={{ width: '40%' }}\n            >\n              <Text style={{ color: 'white' }} >Enviar</Text>\n            </TouchableOpacity>\n          </View>\n        </View>\n      </ScrollView>\n    );\n  }\n\n  _maybeRenderUploadingOverlay = () => { //done\n    if (this.state.uploading) {\n      return (\n        <View\n          style={styles.maybeRenderUploading}>\n          <ActivityIndicator color=\"#313869\" size=\"large\" />\n        </View>\n      );\n    }\n  };\n\n  _maybeRenderImage = () => { //done\n    let {\n      image\n    } = this.state;\n\n    if (!image) {\n      return;\n    }\n\n    // onPress={this._copyToClipboard}\n    // onLongPress={this._share}\n\n    return (\n      <View\n        style={styles.maybeRenderContainer}>\n        <View\n          style={styles.maybeRenderImageContainer}>\n          <Image source={{ uri: image }} style={styles.maybeRenderImage} />\n        </View>\n      </View>\n    );\n  };\n\n  _share = () => {\n    Share.share({\n      message: this.state.image,\n      title: 'Check out this photo',\n      url: this.state.image,\n    });\n  };\n\n  _copyToClipboard = () => {\n    Clipboard.setString(this.state.image);\n    alert('Copied image URL to clipboard');\n  };\n\n  _takePhoto = async () => { //Done\n    const {\n      status: cameraPerm\n    } = await Permissions.askAsync(Permissions.CAMERA);\n\n    const {\n      status: cameraRollPerm\n    } = await Permissions.askAsync(Permissions.CAMERA_ROLL);\n\n  // only if user allows permission to camera AND camera roll\n    if (cameraPerm === 'granted' && cameraRollPerm === 'granted') {\n      let pickerResult = await ImagePicker.launchCameraAsync({\n        allowsEditing: true,\n      });\n\n      this._handleImagePicked(pickerResult);\n    }\n  };\n\n  _pickImage = async () => {\n    const {\n      status: cameraRollPerm\n    } = await Permissions.askAsync(Permissions.CAMERA_ROLL);\n\n  // only if user allows permission to camera roll\n    if (cameraRollPerm === 'granted') {\n      let pickerResult = await ImagePicker.launchImageLibraryAsync({\n        allowsEditing: true,\n\n      });\n\n      this._handleImagePicked(pickerResult);\n    }\n  };\n\n  _handleImagePicked = async pickerResult => {\n    let uploadResponse, uploadResult;\n\n    try {\n      this.setState({\n        uploading: true\n      });\n\n      if (!pickerResult.cancelled) {\n        uploadResponse = await uploadImageAsync(pickerResult.uri);\n        uploadResult = await uploadResponse.json();\n\n        console.log(uploadResult.image)\n\n        this.setState({\n          image: uploadResult.image\n        });\n      }\n    } catch (e) {\n      console.log({ uploadResponse });\n      console.log({ uploadResult });\n      console.log({ e });\n      alert('Upload failed, sorry :(');\n    } finally {\n      this.setState({\n      uploading: false\n      });\n    }\n  };\n}\n\n  async function uploadImageAsync(uri) {\n    let apiUrl = NOTIFICATIONS_API + '/notificationsimage/';\n\n    // Note:\n    // Uncomment this if you want to experiment with local server\n    //\n    // if (Constants.isDevice) {\n    //   apiUrl = `https://your-ngrok-subdomain.ngrok.io/upload`;\n    // } else {\n    //   apiUrl = `http://localhost:3000/upload`\n    // }\n\n    let uriParts = uri.split('.');\n    let fileType = uriParts[uriParts.length - 1];\n\n    let formData = new FormData();\n    formData.append('image', {\n      uri,\n      name: `photo.${fileType}`,\n      type: `image/${fileType}`,\n    });\n\n    console.log(uri)\n\n    let options = {\n      method: 'POST',\n      body: formData,\n      headers: {\n        Accept: 'application/json',\n        'Content-Type': 'multipart/form-data',\n      },\n    };\n    return fetch(apiUrl, options);\n  }\n\nconst styles = StyleSheet.create({\n  container: {\n    paddingLeft: 16,\n    paddingRight: 16\n  },\n  text: {\n    paddingTop: 16,\n    color: \"#760f9f\",\n    fontWeight: 'bold',\n  },\n  alternativeLayoutButtonContainer: {\n    flexDirection: 'row',\n    justifyContent: 'space-between',\n    paddingTop: 4,\n    paddingRight: 4,\n  },\n  button: {\n    backgroundColor: \"#760f9f\",\n    borderRadius: 15,\n    height: 40,\n    width: 190,\n    flexDirection: 'row',\n    justifyContent: 'center',\n    alignItems: 'center'\n  },\n  button2: {\n    backgroundColor: \"#540b71\",\n    borderRadius: 15,\n    height: 40,\n    width: 120,\n    flexDirection: 'row',\n    justifyContent: 'center',\n    alignItems: 'center'\n  },\n  button3: {\n    backgroundColor: \"#760f9f\",\n    borderRadius: 15,\n    height: 40,\n    width: 120,\n    flexDirection: 'row',\n    justifyContent: 'center',\n    alignItems: 'center'\n  },\n  container1: {\n    paddingTop: 20,\n    flexDirection: 'row',\n    justifyContent: 'center'\n  },\n  header: {\n    color: \"#760f9f\",\n    textAlign: 'center',\n    fontWeight: '200',\n    fontSize: 50,\n    marginTop: 25\n  },\n  maybeRenderUploading: {\n    paddingTop: 8,\n    alignItems: 'center',\n    backgroundColor: 'rgba(0,0,0,0.0)',\n    justifyContent: 'center',\n  },\n  maybeRenderContainer: {\n    width: '100%',\n    height: '40%',\n    justifyContent: 'center',\n    alignItems: 'center',\n    borderRadius: 3,\n    elevation: 2,\n    marginTop: 32,\n    shadowColor: 'rgba(0,0,0,1)',\n    shadowOpacity: 0.2,\n    shadowOffset: {\n      height: 4,\n      width: 4,\n    },\n    shadowRadius: 5\n  },\n  maybeRenderImageContainer: {\n    borderTopLeftRadius: 3,\n    borderTopRightRadius: 3,\n    overflow: 'hidden',\n  },\n  maybeRenderImage: {\n    height: 250,\n    width: 250,\n  }\n});\n"]}