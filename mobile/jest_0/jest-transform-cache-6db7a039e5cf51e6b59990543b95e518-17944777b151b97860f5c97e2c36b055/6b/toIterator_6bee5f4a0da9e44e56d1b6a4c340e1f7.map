{"version":3,"sources":["toIterator.js"],"names":["KIND_KEY","KIND_VALUE","KIND_KEY_VAL","ITERATOR_SYMBOL","Symbol","iterator","toIterator","Array","prototype","String","ArrayIterator","array","kind","isArray","TypeError","_iteratedObject","_kind","_nextIndex","createIterResultObject","undefined","len","length","index","StringIterator","string","_iteratedString","s","ret","first","charCodeAt","second","value","done","object","module","exports"],"mappings":"AAQA,a,+2BAYA,GAAIA,UAAW,KAAf,CACA,GAAIC,YAAa,OAAjB,CACA,GAAIC,cAAe,WAAnB,CAEA,GAAIC,iBAAmB,MAAOC,OAAP,GAAkB,UAAnB,4BAChBA,OAAOC,QADS,cAEhB,YAFN,CAIA,GAAIC,YAAc,UAAW,CAC3B,GAAI,EAAEC,MAAMC,SAAN,CAAgBL,eAAhB,GACAM,OAAOD,SAAP,CAAiBL,eAAjB,CADF,CAAJ,CAC0C,CAExC,MAAQ,WAAW,IACXO,cADW,YAGf,uBAAYC,KAAZ,CAAmBC,IAAnB,CAAyB,qCACvB,GAAI,CAACL,MAAMM,OAAN,CAAcF,KAAd,CAAL,CAA2B,CACzB,KAAM,IAAIG,UAAJ,CAAc,wBAAd,CAAN,CACD,CACD,KAAKC,eAAL,CAAuBJ,KAAvB,CACA,KAAKK,KAAL,CAAaJ,IAAb,CACA,KAAKK,UAAL,CAAkB,CAAlB,CACD,CAVc,6DAaR,CACL,GAAI,CAAC,IAAD,WAAiBP,cAArB,CAAoC,CAClC,KAAM,IAAII,UAAJ,CAAc,gCAAd,CAAN,CACD,CAED,GAAI,KAAKC,eAAL,EAAwB,IAA5B,CAAkC,CAChC,MAAOG,wBAAuBC,SAAvB,CAAkC,IAAlC,CAAP,CACD,CAED,GAAIR,OAAQ,KAAKI,eAAjB,CACA,GAAIK,KAAM,KAAKL,eAAL,CAAqBM,MAA/B,CACA,GAAIC,OAAQ,KAAKL,UAAjB,CACA,GAAIL,MAAO,KAAKI,KAAhB,CAEA,GAAIM,OAASF,GAAb,CAAkB,CAChB,KAAKL,eAAL,CAAuBI,SAAvB,CACA,MAAOD,wBAAuBC,SAAvB,CAAkC,IAAlC,CAAP,CACD,CAED,KAAKF,UAAL,CAAkBK,MAAQ,CAA1B,CAEA,GAAIV,OAASZ,QAAb,CAAuB,CACrB,MAAOkB,wBAAuBI,KAAvB,CAA8B,KAA9B,CAAP,CACD,CAFD,IAEO,IAAIV,OAASX,UAAb,CAAyB,CAC9B,MAAOiB,wBAAuBP,MAAMW,KAAN,CAAvB,CAAqC,KAArC,CAAP,CACD,CAFM,IAEA,IAAIV,OAASV,YAAb,CAA2B,CAChC,MAAOgB,wBAAuB,CAACI,KAAD,CAAQX,MAAMW,KAAN,CAAR,CAAvB,CAA8C,KAA9C,CAAP,CACD,CACF,CAzCc,OA4Cf,YA5Ce,0BA4CA,CACb,MAAO,KAAP,CACD,CA9Cc,gCAiDXC,eAjDW,YAmDf,wBAAYC,MAAZ,CAAoB,sCAClB,GAAI,MAAOA,OAAP,GAAkB,QAAtB,CAAgC,CAC9B,KAAM,IAAIV,UAAJ,CAAc,wBAAd,CAAN,CACD,CACD,KAAKW,eAAL,CAAuBD,MAAvB,CACA,KAAKP,UAAL,CAAkB,CAAlB,CACD,CAzDc,8DA4DR,CACL,GAAI,CAAC,IAAD,WAAiBM,eAArB,CAAqC,CACnC,KAAM,IAAIT,UAAJ,CAAc,gCAAd,CAAN,CACD,CAED,GAAI,KAAKW,eAAL,EAAwB,IAA5B,CAAkC,CAChC,MAAOP,wBAAuBC,SAAvB,CAAkC,IAAlC,CAAP,CACD,CAED,GAAIG,OAAQ,KAAKL,UAAjB,CACA,GAAIS,GAAI,KAAKD,eAAb,CACA,GAAIL,KAAMM,EAAEL,MAAZ,CAEA,GAAIC,OAASF,GAAb,CAAkB,CAChB,KAAKK,eAAL,CAAuBN,SAAvB,CACA,MAAOD,wBAAuBC,SAAvB,CAAkC,IAAlC,CAAP,CACD,CAED,GAAIQ,IAAJ,CACA,GAAIC,OAAQF,EAAEG,UAAF,CAAaP,KAAb,CAAZ,CAEA,GAAIM,MAAQ,MAAR,EAAkBA,MAAQ,MAA1B,EAAoCN,MAAQ,CAAR,GAAcF,GAAtD,CAA2D,CACzDO,IAAMD,EAAEJ,KAAF,CAAN,CACD,CAFD,IAEO,CACL,GAAIQ,QAASJ,EAAEG,UAAF,CAAaP,MAAQ,CAArB,CAAb,CACA,GAAIQ,OAAS,MAAT,EAAmBA,OAAS,MAAhC,CAAwC,CACtCH,IAAMD,EAAEJ,KAAF,CAAN,CACD,CAFD,IAEO,CACLK,IAAMD,EAAEJ,KAAF,EAAWI,EAAEJ,MAAQ,CAAV,CAAjB,CACD,CACF,CAED,KAAKL,UAAL,CAAkBK,MAAQK,IAAIN,MAA9B,CAEA,MAAOH,wBAAuBS,GAAvB,CAA4B,KAA5B,CAAP,CACD,CA/Fc,OAkGf,YAlGe,0BAkGA,CACb,MAAO,KAAP,CACD,CApGc,8BAwGjB,QAAST,uBAAT,CAAgCa,KAAhC,CAAuCC,IAAvC,CAA6C,CAC3C,MAAO,CAACD,MAAOA,KAAR,CAAeC,KAAMA,IAArB,CAAP,CACD,CAED,MAAO,UAASC,MAAT,CAAiBrB,IAAjB,CAAuB,CAC5B,GAAI,MAAOqB,OAAP,GAAkB,QAAtB,CAAgC,CAC9B,MAAO,IAAIV,eAAJ,CAAmBU,MAAnB,CAAP,CACD,CAFD,IAEO,IAAI1B,MAAMM,OAAN,CAAcoB,MAAd,CAAJ,CAA2B,CAChC,MAAO,IAAIvB,cAAJ,CAAkBuB,MAAlB,CAA0BrB,MAAQX,UAAlC,CAAP,CACD,CAFM,IAEA,CACL,MAAOgC,QAAO9B,eAAP,GAAP,CACD,CACF,CARD,CASD,CArHM,EAAP,CAsHD,CAzHD,IAyHO,CACL,MAAO,UAAS8B,MAAT,CAAiB,CACtB,MAAOA,QAAO9B,eAAP,GAAP,CACD,CAFD,CAGD,CACF,CA/HgB,EAAjB,CAqIA,SAAcG,UAAd,CAA0B,CACxBN,iBADwB,CAExBC,qBAFwB,CAGxBC,yBAHwB,CAIxBC,+BAJwB,CAA1B,EAOA+B,OAAOC,OAAP,CAAiB7B,UAAjB","file":"toIterator.js","sourcesContent":["/**\n * Copyright (c) 2015-present, Facebook, Inc.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n * @providesModule toIterator\n */\n'use strict';\n\n/**\n * Given an object `toIterator` will return the itrator for that object. If the\n * object has a `Symbol.iterator` method we just call that. Otherwise we\n * implement the ES6 `Array` and `String` Iterator.\n */\n\n/**\n * Constants\n */\n\nvar KIND_KEY = 'key';\nvar KIND_VALUE = 'value';\nvar KIND_KEY_VAL = 'key+value';\n/*global Symbol: true*/\nvar ITERATOR_SYMBOL = (typeof Symbol === 'function')\n    ? Symbol.iterator\n    : '@@iterator';\n\nvar toIterator = (function() {\n  if (!(Array.prototype[ITERATOR_SYMBOL] &&\n        String.prototype[ITERATOR_SYMBOL])) {\n    // IIFE to avoid creating classes for no reason because of hoisting.\n    return (function() {\n      class ArrayIterator {\n        // 22.1.5.1 CreateArrayIterator Abstract Operation\n        constructor(array, kind) {\n          if (!Array.isArray(array)) {\n            throw new TypeError('Object is not an Array');\n          }\n          this._iteratedObject = array;\n          this._kind = kind;\n          this._nextIndex = 0;\n        }\n\n        // 22.1.5.2.1 %ArrayIteratorPrototype%.next()\n        next() {\n          if (!this instanceof ArrayIterator) {\n            throw new TypeError('Object is not an ArrayIterator');\n          }\n\n          if (this._iteratedObject == null) {\n            return createIterResultObject(undefined, true);\n          }\n\n          var array = this._iteratedObject;\n          var len = this._iteratedObject.length;\n          var index = this._nextIndex;\n          var kind = this._kind;\n\n          if (index >= len) {\n            this._iteratedObject = undefined;\n            return createIterResultObject(undefined, true);\n          }\n\n          this._nextIndex = index + 1;\n\n          if (kind === KIND_KEY) {\n            return createIterResultObject(index, false);\n          } else if (kind === KIND_VALUE) {\n            return createIterResultObject(array[index], false);\n          } else if (kind === KIND_KEY_VAL) {\n            return createIterResultObject([index, array[index]], false);\n          }\n        }\n\n        // 22.1.5.2.2 %ArrayIteratorPrototype%[@@iterator]()\n        '@@iterator'() {\n          return this;\n        }\n      }\n\n      class StringIterator {\n        // 21.1.5.1 CreateStringIterator Abstract Operation\n        constructor(string) {\n          if (typeof string !== 'string') {\n            throw new TypeError('Object is not a string');\n          }\n          this._iteratedString = string;\n          this._nextIndex = 0;\n        }\n\n        // 21.1.5.2.1 %StringIteratorPrototype%.next()\n        next() {\n          if (!this instanceof StringIterator) {\n            throw new TypeError('Object is not a StringIterator');\n          }\n\n          if (this._iteratedString == null) {\n            return createIterResultObject(undefined, true);\n          }\n\n          var index = this._nextIndex;\n          var s = this._iteratedString;\n          var len = s.length;\n\n          if (index >= len) {\n            this._iteratedString = undefined;\n            return createIterResultObject(undefined, true);\n          }\n\n          var ret;\n          var first = s.charCodeAt(index);\n\n          if (first < 0xD800 || first > 0xDBFF || index + 1 === len) {\n            ret = s[index];\n          } else {\n            var second = s.charCodeAt(index + 1);\n            if (second < 0xDC00 || second > 0xDFFF) {\n              ret = s[index];\n            } else {\n              ret = s[index] + s[index + 1];\n            }\n          }\n\n          this._nextIndex = index + ret.length;\n\n          return createIterResultObject(ret, false);\n        }\n\n        // 21.1.5.2.2 %StringIteratorPrototype%[@@ITERATOR_SYMBOL]()\n        '@@iterator'() {\n          return this;\n        }\n      }\n\n      // 7.4.7 createIterResultObject(value, done)\n      function createIterResultObject(value, done) {\n        return {value: value, done: done};\n      }\n\n      return function(object, kind) {\n        if (typeof object === 'string') {\n          return new StringIterator(object);\n        } else if (Array.isArray(object)) {\n          return new ArrayIterator(object, kind || KIND_VALUE);\n        } else {\n          return object[ITERATOR_SYMBOL]();\n        }\n      };\n    })();\n  } else {\n    return function(object) {\n      return object[ITERATOR_SYMBOL]();\n    };\n  }\n})();\n\n/**\n * Export constants\n */\n\nObject.assign(toIterator, {\n  KIND_KEY,\n  KIND_VALUE,\n  KIND_KEY_VAL,\n  ITERATOR_SYMBOL\n});\n\nmodule.exports = toIterator;\n"]}