72098fe25c61c7a6377520489e75ca17
'use strict';var _extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key];}}}return target;};var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor);}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor;};}();function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}var KIND_KEY='key';var KIND_VALUE='value';var KIND_KEY_VAL='key+value';var ITERATOR_SYMBOL=typeof Symbol==='function'?typeof Symbol==='function'?Symbol.iterator:'@@iterator':'@@iterator';var toIterator=function(){if(!(Array.prototype[ITERATOR_SYMBOL]&&String.prototype[ITERATOR_SYMBOL])){return function(){var ArrayIterator=function(){function ArrayIterator(array,kind){_classCallCheck(this,ArrayIterator);if(!Array.isArray(array)){throw new TypeError('Object is not an Array');}this._iteratedObject=array;this._kind=kind;this._nextIndex=0;}_createClass(ArrayIterator,[{key:'next',value:function next(){if(!this instanceof ArrayIterator){throw new TypeError('Object is not an ArrayIterator');}if(this._iteratedObject==null){return createIterResultObject(undefined,true);}var array=this._iteratedObject;var len=this._iteratedObject.length;var index=this._nextIndex;var kind=this._kind;if(index>=len){this._iteratedObject=undefined;return createIterResultObject(undefined,true);}this._nextIndex=index+1;if(kind===KIND_KEY){return createIterResultObject(index,false);}else if(kind===KIND_VALUE){return createIterResultObject(array[index],false);}else if(kind===KIND_KEY_VAL){return createIterResultObject([index,array[index]],false);}}},{key:'@@iterator',value:function iterator(){return this;}}]);return ArrayIterator;}();var StringIterator=function(){function StringIterator(string){_classCallCheck(this,StringIterator);if(typeof string!=='string'){throw new TypeError('Object is not a string');}this._iteratedString=string;this._nextIndex=0;}_createClass(StringIterator,[{key:'next',value:function next(){if(!this instanceof StringIterator){throw new TypeError('Object is not a StringIterator');}if(this._iteratedString==null){return createIterResultObject(undefined,true);}var index=this._nextIndex;var s=this._iteratedString;var len=s.length;if(index>=len){this._iteratedString=undefined;return createIterResultObject(undefined,true);}var ret;var first=s.charCodeAt(index);if(first<0xD800||first>0xDBFF||index+1===len){ret=s[index];}else{var second=s.charCodeAt(index+1);if(second<0xDC00||second>0xDFFF){ret=s[index];}else{ret=s[index]+s[index+1];}}this._nextIndex=index+ret.length;return createIterResultObject(ret,false);}},{key:'@@iterator',value:function iterator(){return this;}}]);return StringIterator;}();function createIterResultObject(value,done){return{value:value,done:done};}return function(object,kind){if(typeof object==='string'){return new StringIterator(object);}else if(Array.isArray(object)){return new ArrayIterator(object,kind||KIND_VALUE);}else{return object[ITERATOR_SYMBOL]();}};}();}else{return function(object){return object[ITERATOR_SYMBOL]();};}}();_extends(toIterator,{KIND_KEY:KIND_KEY,KIND_VALUE:KIND_VALUE,KIND_KEY_VAL:KIND_KEY_VAL,ITERATOR_SYMBOL:ITERATOR_SYMBOL});module.exports=toIterator;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInRvSXRlcmF0b3IuanMiXSwibmFtZXMiOlsiS0lORF9LRVkiLCJLSU5EX1ZBTFVFIiwiS0lORF9LRVlfVkFMIiwiSVRFUkFUT1JfU1lNQk9MIiwiU3ltYm9sIiwiaXRlcmF0b3IiLCJ0b0l0ZXJhdG9yIiwiQXJyYXkiLCJwcm90b3R5cGUiLCJTdHJpbmciLCJBcnJheUl0ZXJhdG9yIiwiYXJyYXkiLCJraW5kIiwiaXNBcnJheSIsIlR5cGVFcnJvciIsIl9pdGVyYXRlZE9iamVjdCIsIl9raW5kIiwiX25leHRJbmRleCIsImNyZWF0ZUl0ZXJSZXN1bHRPYmplY3QiLCJ1bmRlZmluZWQiLCJsZW4iLCJsZW5ndGgiLCJpbmRleCIsIlN0cmluZ0l0ZXJhdG9yIiwic3RyaW5nIiwiX2l0ZXJhdGVkU3RyaW5nIiwicyIsInJldCIsImZpcnN0IiwiY2hhckNvZGVBdCIsInNlY29uZCIsInZhbHVlIiwiZG9uZSIsIm9iamVjdCIsIm1vZHVsZSIsImV4cG9ydHMiXSwibWFwcGluZ3MiOiJBQVFBLGEsKzJCQVlBLEdBQUlBLFVBQVcsS0FBZixDQUNBLEdBQUlDLFlBQWEsT0FBakIsQ0FDQSxHQUFJQyxjQUFlLFdBQW5CLENBRUEsR0FBSUMsaUJBQW1CLE1BQU9DLE9BQVAsR0FBa0IsVUFBbkIsNEJBQ2hCQSxPQUFPQyxRQURTLGNBRWhCLFlBRk4sQ0FJQSxHQUFJQyxZQUFjLFVBQVcsQ0FDM0IsR0FBSSxFQUFFQyxNQUFNQyxTQUFOLENBQWdCTCxlQUFoQixHQUNBTSxPQUFPRCxTQUFQLENBQWlCTCxlQUFqQixDQURGLENBQUosQ0FDMEMsQ0FFeEMsTUFBUSxXQUFXLElBQ1hPLGNBRFcsWUFHZix1QkFBWUMsS0FBWixDQUFtQkMsSUFBbkIsQ0FBeUIscUNBQ3ZCLEdBQUksQ0FBQ0wsTUFBTU0sT0FBTixDQUFjRixLQUFkLENBQUwsQ0FBMkIsQ0FDekIsS0FBTSxJQUFJRyxVQUFKLENBQWMsd0JBQWQsQ0FBTixDQUNELENBQ0QsS0FBS0MsZUFBTCxDQUF1QkosS0FBdkIs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QVFLLElBQUlOLE1BQTlCLENBRUEsTUFBT0gsd0JBQXVCUyxHQUF2QixDQUE0QixLQUE1QixDQUFQLENBQ0QsQ0EvRmMsT0FrR2YsWUFsR2UsMEJBa0dBLENBQ2IsTUFBTyxLQUFQLENBQ0QsQ0FwR2MsOEJBd0dqQixRQUFTVCx1QkFBVCxDQUFnQ2EsS0FBaEMsQ0FBdUNDLElBQXZDLENBQTZDLENBQzNDLE1BQU8sQ0FBQ0QsTUFBT0EsS0FBUixDQUFlQyxLQUFNQSxJQUFyQixDQUFQLENBQ0QsQ0FFRCxNQUFPLFVBQVNDLE1BQVQsQ0FBaUJyQixJQUFqQixDQUF1QixDQUM1QixHQUFJLE1BQU9xQixPQUFQLEdBQWtCLFFBQXRCLENBQWdDLENBQzlCLE1BQU8sSUFBSVYsZUFBSixDQUFtQlUsTUFBbkIsQ0FBUCxDQUNELENBRkQsSUFFTyxJQUFJMUIsTUFBTU0sT0FBTixDQUFjb0IsTUFBZCxDQUFKLENBQTJCLENBQ2hDLE1BQU8sSUFBSXZCLGNBQUosQ0FBa0J1QixNQUFsQixDQUEwQnJCLE1BQVFYLFVBQWxDLENBQVAsQ0FDRCxDQUZNLElBRUEsQ0FDTCxNQUFPZ0MsUUFBTzlCLGVBQVAsR0FBUCxDQUNELENBQ0YsQ0FSRCxDQVNELENBckhNLEVBQVAsQ0FzSEQsQ0F6SEQsSUF5SE8sQ0FDTCxNQUFPLFVBQVM4QixNQUFULENBQWlCLENBQ3RCLE1BQU9BLFFBQU85QixlQUFQLEdBQVAsQ0FDRCxDQUZELENBR0QsQ0FDRixDQS9IZ0IsRUFBakIsQ0FxSUEsU0FBY0csVUFBZCxDQUEwQixDQUN4Qk4saUJBRHdCLENBRXhCQyxxQkFGd0IsQ0FHeEJDLHlCQUh3QixDQUl4QkMsK0JBSndCLENBQTFCLEVBT0ErQixPQUFPQyxPQUFQLENBQWlCN0IsVUFBakIiLCJmaWxlIjoidG9JdGVyYXRvci5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogQ29weXJpZ2h0IChjKSAyMDE1LXByZXNlbnQsIEZhY2Vib29rLCBJbmMuXG4gKlxuICogVGhpcyBzb3VyY2UgY29kZSBpcyBsaWNlbnNlZCB1bmRlciB0aGUgTUlUIGxpY2Vuc2UgZm91bmQgaW4gdGhlXG4gKiBMSUNFTlNFIGZpbGUgaW4gdGhlIHJvb3QgZGlyZWN0b3J5IG9mIHRoaXMgc291cmNlIHRyZWUuXG4gKlxuICogQHByb3ZpZGVzTW9kdWxlIHRvSXRlcmF0b3JcbiAqL1xuJ3VzZSBzdHJpY3QnO1xuXG4vKipcbiAqIEdpdmVuIGFuIG9iamVjdCBgdG9JdGVyYXRvcmAgd2lsbCByZXR1cm4gdGhlIGl0cmF0b3IgZm9yIHRoYXQgb2JqZWN0LiBJZiB0aGVcbiAqIG9iamVjdCBoYXMgYSBgU3ltYm9sLml0ZXJhdG9yYCBtZXRob2Qgd2UganVzdCBjYWxsIHRoYXQuIE90aGVyd2lzZSB3ZVxuICogaW1wbGVtZW50IHRoZSBFUzYgYEFycmF5YCBhbmQgYFN0cmluZ2AgSXRlcmF0b3IuXG4gKi9cblxuLyoqXG4gKiBDb25zdGFudHNcbiAqL1xuXG52YXIgS0lORF9LRVkgPSAna2V5JztcbnZhciBLSU5EX1ZBTFVFID0gJ3ZhbHVlJztcbnZhciBLSU5EX0tFWV9WQUwgPSAna2V5K3ZhbHVlJztcbi8qZ2xvYmFsIFN5bWJvbDogdHJ1ZSovXG52YXIgSVRFUkFUT1JfU1lNQk9MID0gKHR5cGVvZiBTeW1ib2wgPT09ICdmdW5jdGlvbicpXG4gICAgPyBTeW1ib2wuaXRlcmF0b3JcbiAgICA6ICdAQGl0ZXJhdG9yJztcblxudmFyIHRvSXRlcmF0b3IgPSAoZnVuY3Rpb24oKSB7XG4gIGlmICghKEFycmF5LnByb3RvdHlwZVtJVEVSQVRPUl9TWU1CT0xdICYmXG4gICAgICAgIFN0cmluZy5wcm90b3R5cGVbSVRFUkFUT1JfU1lNQk9MXSkpIHtcbiAgICAvLyBJSUZFIHRvIGF2b2lkIGNyZWF0aW5nIGNsYXNzZXMgZm9yIG5vIHJlYXNvbiBiZWNhdXNlIG9mIGhvaXN0aW5nLlxuICAgIHJldHVybiAoZnVuY3Rpb24oKSB7XG4gICAgICBjbGFzcyBBcnJheUl0ZXJhdG9yIHtcbiAgICAgICAgLy8gMjIuMS41LjEgQ3JlYXRlQXJyYXlJdGVyYXRvciBBYnN0cmFjdCBPcGVyYXRpb25cbiAgICAgICAgY29uc3RydWN0b3IoYXJyYXksIGtpbmQpIHtcbiAgICAgICAgICBpZiAoIUFycmF5LmlzQXJyYXkoYXJyYXkpKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdPYmplY3QgaXMgbm90IGFuIEFycmF5Jyk7XG4gICAgICAgICAgfVxuICAgICAgICAgIHRoaXMuX2l0ZXJhdGVkT2JqZWN0ID0gYXJyYXk7XG4gICAgICAgICAgdGhpcy5fa2luZCA9IGtpbmQ7XG4gICAgICAgICAgdGhpcy5fbmV4dEluZGV4ID0gMDtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIDIyLjEuNS4yLjEgJUFycmF5SXRlcmF0b3JQcm90b3R5cGUlLm5leHQoKVxuICAgICAgICBuZXh0KCkge1xuICAgICAgICAgIGlmICghdGhpcyBpbnN0YW5jZW9mIEFycmF5SXRlcmF0b3IpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ09iamVjdCBpcyBub3QgYW4gQXJyYXlJdGVyYXRvcicpO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIGlmICh0aGlzLl9pdGVyYXRlZE9iamVjdCA9PSBudWxsKSB7XG4gICAgICAgICAgICByZXR1cm4gY3JlYXRlSXRlclJlc3VsdE9iamVjdCh1bmRlZmluZWQsIHRydWUpO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIHZhciBhcnJheSA9IHRoaXMuX2l0ZXJhdGVkT2JqZWN0O1xuICAgICAgICAgIHZhciBsZW4gPSB0aGlzLl9pdGVyYXRlZE9iamVjdC5sZW5ndGg7XG4gICAgICAgICAgdmFyIGluZGV4ID0gdGhpcy5fbmV4dEluZGV4O1xuICAgICAgICAgIHZhciBraW5kID0gdGhpcy5fa2luZDtcblxuICAgICAgICAgIGlmIChpbmRleCA+PSBsZW4pIHtcbiAgICAgICAgICAgIHRoaXMuX2l0ZXJhdGVkT2JqZWN0ID0gdW5kZWZpbmVkO1xuICAgICAgICAgICAgcmV0dXJuIGNyZWF0ZUl0ZXJSZXN1bHRPYmplY3QodW5kZWZpbmVkLCB0cnVlKTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICB0aGlzLl9uZXh0SW5kZXggPSBpbmRleCArIDE7XG5cbiAgICAgICAgICBpZiAoa2luZCA9PT0gS0lORF9LRVkpIHtcbiAgICAgICAgICAgIHJldHVybiBjcmVhdGVJdGVyUmVzdWx0T2JqZWN0KGluZGV4LCBmYWxzZSk7XG4gICAgICAgICAgfSBlbHNlIGlmIChraW5kID09PSBLSU5EX1ZBTFVFKSB7XG4gICAgICAgICAgICByZXR1cm4gY3JlYXRlSXRlclJlc3VsdE9iamVjdChhcnJheVtpbmRleF0sIGZhbHNlKTtcbiAgICAgICAgICB9IGVsc2UgaWYgKGtpbmQgPT09IEtJTkRfS0VZX1ZBTCkge1xuICAgICAgICAgICAgcmV0dXJuIGNyZWF0ZUl0ZXJSZXN1bHRPYmplY3QoW2luZGV4LCBhcnJheVtpbmRleF1dLCBmYWxzZSk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgLy8gMjIuMS41LjIuMiAlQXJyYXlJdGVyYXRvclByb3RvdHlwZSVbQEBpdGVyYXRvcl0oKVxuICAgICAgICAnQEBpdGVyYXRvcicoKSB7XG4gICAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgY2xhc3MgU3RyaW5nSXRlcmF0b3Ige1xuICAgICAgICAvLyAyMS4xLjUuMSBDcmVhdGVTdHJpbmdJdGVyYXRvciBBYnN0cmFjdCBPcGVyYXRpb25cbiAgICAgICAgY29uc3RydWN0b3Ioc3RyaW5nKSB7XG4gICAgICAgICAgaWYgKHR5cGVvZiBzdHJpbmcgIT09ICdzdHJpbmcnKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdPYmplY3QgaXMgbm90IGEgc3RyaW5nJyk7XG4gICAgICAgICAgfVxuICAgICAgICAgIHRoaXMuX2l0ZXJhdGVkU3RyaW5nID0gc3RyaW5nO1xuICAgICAgICAgIHRoaXMuX25leHRJbmRleCA9IDA7XG4gICAgICAgIH1cblxuICAgICAgICAvLyAyMS4xLjUuMi4xICVTdHJpbmdJdGVyYXRvclByb3RvdHlwZSUubmV4dCgpXG4gICAgICAgIG5leHQoKSB7XG4gICAgICAgICAgaWYgKCF0aGlzIGluc3RhbmNlb2YgU3RyaW5nSXRlcmF0b3IpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ09iamVjdCBpcyBub3QgYSBTdHJpbmdJdGVyYXRvcicpO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIGlmICh0aGlzLl9pdGVyYXRlZFN0cmluZyA9PSBudWxsKSB7XG4gICAgICAgICAgICByZXR1cm4gY3JlYXRlSXRlclJlc3VsdE9iamVjdCh1bmRlZmluZWQsIHRydWUpO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIHZhciBpbmRleCA9IHRoaXMuX25leHRJbmRleDtcbiAgICAgICAgICB2YXIgcyA9IHRoaXMuX2l0ZXJhdGVkU3RyaW5nO1xuICAgICAgICAgIHZhciBsZW4gPSBzLmxlbmd0aDtcblxuICAgICAgICAgIGlmIChpbmRleCA+PSBsZW4pIHtcbiAgICAgICAgICAgIHRoaXMuX2l0ZXJhdGVkU3RyaW5nID0gdW5kZWZpbmVkO1xuICAgICAgICAgICAgcmV0dXJuIGNyZWF0ZUl0ZXJSZXN1bHRPYmplY3QodW5kZWZpbmVkLCB0cnVlKTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICB2YXIgcmV0O1xuICAgICAgICAgIHZhciBmaXJzdCA9IHMuY2hhckNvZGVBdChpbmRleCk7XG5cbiAgICAgICAgICBpZiAoZmlyc3QgPCAweEQ4MDAgfHwgZmlyc3QgPiAweERCRkYgfHwgaW5kZXggKyAxID09PSBsZW4pIHtcbiAgICAgICAgICAgIHJldCA9IHNbaW5kZXhdO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB2YXIgc2Vjb25kID0gcy5jaGFyQ29kZUF0KGluZGV4ICsgMSk7XG4gICAgICAgICAgICBpZiAoc2Vjb25kIDwgMHhEQzAwIHx8IHNlY29uZCA+IDB4REZGRikge1xuICAgICAgICAgICAgICByZXQgPSBzW2luZGV4XTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgIHJldCA9IHNbaW5kZXhdICsgc1tpbmRleCArIDFdO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cblxuICAgICAgICAgIHRoaXMuX25leHRJbmRleCA9IGluZGV4ICsgcmV0Lmxlbmd0aDtcblxuICAgICAgICAgIHJldHVybiBjcmVhdGVJdGVyUmVzdWx0T2JqZWN0KHJldCwgZmFsc2UpO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gMjEuMS41LjIuMiAlU3RyaW5nSXRlcmF0b3JQcm90b3R5cGUlW0BASVRFUkFUT1JfU1lNQk9MXSgpXG4gICAgICAgICdAQGl0ZXJhdG9yJygpIHtcbiAgICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICAvLyA3LjQuNyBjcmVhdGVJdGVyUmVzdWx0T2JqZWN0KHZhbHVlLCBkb25lKVxuICAgICAgZnVuY3Rpb24gY3JlYXRlSXRlclJlc3VsdE9iamVjdCh2YWx1ZSwgZG9uZSkge1xuICAgICAgICByZXR1cm4ge3ZhbHVlOiB2YWx1ZSwgZG9uZTogZG9uZX07XG4gICAgICB9XG5cbiAgICAgIHJldHVybiBmdW5jdGlvbihvYmplY3QsIGtpbmQpIHtcbiAgICAgICAgaWYgKHR5cGVvZiBvYmplY3QgPT09ICdzdHJpbmcnKSB7XG4gICAgICAgICAgcmV0dXJuIG5ldyBTdHJpbmdJdGVyYXRvcihvYmplY3QpO1xuICAgICAgICB9IGVsc2UgaWYgKEFycmF5LmlzQXJyYXkob2JqZWN0KSkge1xuICAgICAgICAgIHJldHVybiBuZXcgQXJyYXlJdGVyYXRvcihvYmplY3QsIGtpbmQgfHwgS0lORF9WQUxVRSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgcmV0dXJuIG9iamVjdFtJVEVSQVRPUl9TWU1CT0xdKCk7XG4gICAgICAgIH1cbiAgICAgIH07XG4gICAgfSkoKTtcbiAgfSBlbHNlIHtcbiAgICByZXR1cm4gZnVuY3Rpb24ob2JqZWN0KSB7XG4gICAgICByZXR1cm4gb2JqZWN0W0lURVJBVE9SX1NZTUJPTF0oKTtcbiAgICB9O1xuICB9XG59KSgpO1xuXG4vKipcbiAqIEV4cG9ydCBjb25zdGFudHNcbiAqL1xuXG5PYmplY3QuYXNzaWduKHRvSXRlcmF0b3IsIHtcbiAgS0lORF9LRVksXG4gIEtJTkRfVkFMVUUsXG4gIEtJTkRfS0VZX1ZBTCxcbiAgSVRFUkFUT1JfU1lNQk9MXG59KTtcblxubW9kdWxlLmV4cG9ydHMgPSB0b0l0ZXJhdG9yO1xuIl19